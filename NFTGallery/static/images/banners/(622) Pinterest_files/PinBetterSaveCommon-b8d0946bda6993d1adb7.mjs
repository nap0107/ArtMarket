(window.__LOADABLE_LOADED_CHUNKS__=window.__LOADABLE_LOADED_CHUNKS__||[]).push([["PinBetterSaveCommon",35,242,"PinRepEditButtonCommon"],{"+c4W":function(e,t,n){var i=n("711d"),o=n("4/ic"),r=n("9ggG"),s=n("9Nap");e.exports=function(e){return r(e)?i(s(e)):o(e)}},"/WHw":function(e,t,n){n.d(t,"a",(function(){return j}));var i=n("q1tI"),o=n("/MKj"),r=n("JW66"),s=n("Ye/N"),a=n("5FNA"),c=n("Wer7"),d=n("vvax"),l=n("ANjH"),u=n("oN2T"),h=n("c50B"),b=n("nKUr");function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function m(e){var t,n;return n=t=class extends i.Component{constructor(...e){super(...e),p(this,"state",{createBoardError:null,inputName:this.props.prefilledName||"",nameValidators:[Object(h.p)({message:s.a._("Don't forget to name your board!")}),Object(h.j)({max:r.a.MAX_CHARS_FOR_BOARD_TITLE,maxErrorString:Object(d.b)(s.a._("Please enter no more than {{ maxLength }} characters.","Validation error when a user input is too long","Validation error when a user input is too long"),{maxLength:r.a.MAX_CHARS_FOR_BOARD_TITLE}).join("")})],nameValidatorErrors:[],privacy:this.props.isAdAccountOwner?r.a.BoardPrivacy.PUBLIC:r.a.BoardPrivacy.PROTECTED,saving:!1}),p(this,"invalidateResource",e=>{const{dispatch:t,viewer:n}=this.props;t(Object(c.f)("BoardsResource",Object(a.a)(n.isAuth?n.username:"",e===r.a.BoardPrivacy.SECRET)))}),p(this,"createBoard",e=>{const{dispatch:t,viewer:n}=this.props,i=n.isAuth?n.username:"";return t(Object(u.g)(e,{isFBC:n.isAuth&&0===n.boardCount},i))}),p(this,"handleChangeName",(e,t)=>{const n=Object(h.s)(this.state.nameValidators,e);this.setState({inputName:e,nameValidatorErrors:n,createBoardError:null},()=>{t&&this.handleCreate()})}),p(this,"handleChangePrivacy",()=>{const e=this.state.privacy===r.a.BoardPrivacy.SECRET?r.a.BoardPrivacy.PUBLIC:r.a.BoardPrivacy.SECRET;this.setState({privacy:e})}),p(this,"handleCreate",()=>{const{inputName:e,privacy:t}=this.state,{isAdAccountOwner:n,onCreate:i,advertiser_id:o}=this.props,r={privacy:t,name:e,...!n&&o?{advertiser_id:o}:{}};this.setState({saving:!0,createBoardError:null}),this.createBoard(r).then(e=>{this.setState({saving:!1}),i(e)}).catch(e=>{let t=s.a._("Uh oh! Something went wrong.");if("string"==typeof e)t=e;else if(e.message){const{message:n,message_detail:i}=e;t=i?`${n} ${i}`:n}this.setState({saving:!1,createBoardError:t})}),this.invalidateResource(t)})}render(){return Object(b.jsx)(e,{onBoardCreate:this.handleCreate,onChangeBoardName:this.handleChangeName,onChangeBoardPrivacy:this.handleChangePrivacy,...this.props,...this.state})}},p(t,"displayName",`WithBoardCreatePane(${e.displayName||e.name})`),n}function f({advertiser:e,viewer:t}){const n=!e||t.isAuth&&e.owner_user_id===t.id,i=e&&e.id;return{isAdAccountOwner:n,...i?{advertiser_id:i}:{},viewer:t}}function g(e){return{dispatch:e}}function j(e){return Object(l.compose)(Object(o.connect)(f,g),m)(e)}},"0zyx":function(e,t,n){n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return s}));var i=n("mVx/"),o=n.n(i);const r=({pathname:e})=>/^\/pin\/[\w-]+\/?$/.test(e),s=e=>{const t=o()(e,e=>!r(e));return t&&(({pathname:e})=>/^\/search\/pins\//.test(e))(t)?(({pathname:e,search:t})=>{const n=/^\/search\/pins\/(\?.*)$/.exec(e),i=(t||n&&n[1]||"").substr(1).split("&").map(e=>e.split("=")).find(e=>"q"===e[0]);return i?decodeURIComponent(i[1]):""})(t):""}},"1LK5":function(e,t){e.exports=function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}},"4/ic":function(e,t,n){var i=n("ZWtO");e.exports=function(e){return function(t){return i(t,e)}}},"5uyJ":function(e,t,n){n.d(t,"a",(function(){return i}));const i={V_HLSV4:"V_HLSV4",V_720P:"V_720P"}},"6A0I":function(e,t,n){var i=n("q1tI"),o=n("/MKj"),r=n("JW66"),s=n("Sihc"),a=n("GBVV"),c=n("QO9Q"),d=n("xkL+"),l=n("0Xtd"),u=n("yweb"),h=n("n6mq"),b=n("nKUr");function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class m extends i.Component{constructor(e){super(e),p(this,"onCreateSection",()=>{const{board:e,dispatch:t,completeCreateSectionAction:n,pinImport:i,viewer:o,orbacActingAs:r}=this.props,a=Object(l.a)(o,r);return this.setState({isSaving:!0}),t(Object(s.a)({boardId:e.id,name:this.state.inputName.trim(),pinImport:i},this.props.i18n,a)).then(e=>{this.setState({isSaving:!1}),n(e)}).catch(e=>{this.setState({createError:e.message_detail||e.message,isSaving:!1})})}),p(this,"handleKeyDown",({event:e,value:t})=>{const{createError:n,inputName:i}=this.state;[r.a.KeyCode.ENTER,r.a.KeyCode.NUMPAD_ENTER].includes(e.which)&&!n&&i.trim()&&this.onCreateSection()}),p(this,"handleChangeName",({value:e})=>{this.setState({createError:null,inputName:e})}),p(this,"handleInputRef",e=>{this.setState({inputRef:e})}),this.state={createError:null,inputName:e.initialName||"",inputRef:null,isSaving:!1}}componentDidUpdate(e,t){const{createError:n,inputRef:i}=this.state;!i||t.inputRef&&!n||i.focus()}render(){const{showTitle:e,positionRelative:t}=this.props,{createError:n,inputName:i,isSaving:o}=this.state,r=!!i.trim()&&!n;return Object(b.jsxs)(h.f,{display:"flex",direction:"column",color:"white",flex:"grow",top:!0,bottom:!0,right:!0,position:t?"relative":"absolute",rounding:2,width:"100%",dangerouslySetInlineStyle:{__style:{borderLeft:"1px solid #f5f5f5"}},children:[e&&Object(b.jsx)(h.f,{marginTop:3,paddingX:6,paddingY:3,children:Object(b.jsx)(h.v,{size:"sm",children:this.props.i18n._("Add section","Title in the add section modal","Title in the add section modal")})}),Object(b.jsxs)(h.f,{padding:4,children:[Object(b.jsx)(h.f,{marginBottom:2,children:Object(b.jsx)(h.z,{htmlFor:"sectionEditName",children:Object(b.jsx)(h.cb,{size:"md",color:n?"red":"gray",children:this.props.i18n._("Name","Board section name","Board section name")})})}),Object(b.jsx)(h.f,{children:Object(b.jsx)(h.f,{ref:this.handleInputRef,children:Object(b.jsx)(h.eb,{errorMessage:n||"",id:"sectionEditName",name:"sectionName",onChange:this.handleChangeName,onKeyDown:this.handleKeyDown,placeholder:this.props.i18n._('Like "Lighting"',"Placeholder for board section name","Placeholder for board section name"),size:"lg",type:"text",value:i})})})]}),Object(b.jsx)(h.u,{alignItems:"stretch",justifyContent:"start",flex:"grow"}),Object(b.jsx)(h.f,{padding:4,children:Object(b.jsx)(h.u,{alignItems:"stretch",justifyContent:"end",children:Object(b.jsx)(a.b,{disabled:!r||o,onClick:this.onCreateSection,submitting:o,text:this.props.i18n._("Add","add a new section","add a new section")})})})]})}}t.a=Object(o.connect)()((function(e){const t=Object(u.c)(),n=Object(d.b)(),i=Object(c.a)();return Object(b.jsx)(m,{...e,i18n:t,viewer:n,orbacActingAs:i})}))},"6G9P":function(e,t,n){n.d(t,"a",(function(){return a}));var i=n("q1tI"),o=(n("JW66"),n("yaUg")),r=n("n6mq"),s=n("nKUr");const a=(e,t,n)=>n?Object(o.a)(e._("Saved to {{sectionName}} in {{boardName}}","Toast for successfully saving to a section within a board","Toast for successfully saving to a section within a board"),{sectionName:n.title,boardName:null!=t?t:""}):Object(s.jsxs)(i.Fragment,{children:[Object(s.jsx)(r.cb,{children:e._("Saved to")}),Object(s.jsx)(r.cb,{weight:"bold",children:t})]})},"711d":function(e,t){e.exports=function(e){return function(t){return null==t?void 0:t[e]}}},"82UD":function(e,t,n){n.r(t),n.d(t,"default",(function(){return O}));var i=n("q1tI"),o=n("/MKj"),r=n("T+9/"),s=n("ajUs"),a=n("ou9u"),c=n("hFNL"),d=n("yKES"),l=n("5uyJ"),u=n("n6mq"),h=n("nKUr");const b={overlay:{__style:{backgroundColor:"#000"}}};function p(e){var t,n,o,r;const{pin:{id:s,images:a,title:c,videos:p,video_status_message:m}}=e,f=m||{},g=a&&a["236x"],j=p&&(null===(t=p.video_list)||void 0===t?void 0:t[l.a.V_HLSV4]),{duration:O}=j||{};return Object(h.jsx)(i.Fragment,{children:Object(h.jsx)(u.j,{children:Object(h.jsxs)(u.bb,{role:"link",href:"/pin/"+s,rounding:2,children:[Object(h.jsxs)(u.f,{overflow:"hidden",position:"relative",rounding:2,children:[g&&Object(h.jsx)(u.y,{alt:c||"",color:"lightGray",naturalHeight:null!==(n=g.height)&&void 0!==n?n:1,naturalWidth:null!==(o=g.width)&&void 0!==o?o:1,src:null!==(r=g.url)&&void 0!==r?r:""}),!!O&&Object(h.jsx)(u.f,{padding:2,position:"absolute",bottom:!0,left:!0,display:"flex",children:Object(h.jsx)(d.a,{duration:O})}),Object(h.jsx)(u.f,{position:"absolute",top:!0,bottom:!0,left:!0,right:!0,opacity:.4,dangerouslySetInlineStyle:b.overlay}),Object(h.jsxs)(u.f,{position:"absolute",top:!0,left:!0,padding:5,width:"100%",children:[Object(h.jsx)(u.v,{color:"white",overflow:"normal",size:"sm",children:f.title}),Object(h.jsx)(u.f,{marginTop:4,children:Object(h.jsx)(u.cb,{color:"white",size:"md",overflow:"normal",children:f.subtitle})})]})]}),Object(h.jsx)(u.f,{display:"flex",alignItems:"start",justifyContent:"between",marginTop:1,paddingX:1,children:Object(h.jsx)(u.f,{flex:"grow",children:c&&Object(h.jsx)(u.f,{paddingY:1,children:Object(h.jsx)(u.cb,{inline:!0,size:"md",weight:"bold",children:c})})})})]})})})}var m=n("Y8Sn"),f=n("EC67"),g=n("vpxy"),j=n("0nTG");function O({trackingParameters:e,pin:t,pinId:n,...d}){var l,u,b;const O=Object(f.i)(),v=Object(o.useSelector)(({pins:e})=>e[n])||t,x=Object(s.a)(v,O),S=Object(a.a)(v),y=!!(S&&S.url&&S.height&&S.width)||void 0,_=S&&v.videos?v.videos.id:void 0,[w,C]=Object(i.useState)(!1),I=Object(i.useCallback)(()=>C(!0),[]),T=Object(i.useCallback)(()=>C(!1),[]),{componentType:R,contextLogData:P,impressionAuxFields:E,slotIndex:B,viewData:A,viewParameter:k,viewType:N}=e;return Object(h.jsx)(r.a,{componentType:R,contextLogData:{..."undefined"!=typeof window?{pwa_type:Object(c.b)(window)}:{},...P,...Object(j.f)(v,P)},impressionAuxFields:{...E||{},isNativeVideoAndWatchable:y,videoIdStr:_,clientTrackingParams:x||(v.tracking_params||"")+"-0",imageURL:null!==(l=null===(u=v.images)||void 0===u||null===(b=u["236x"])||void 0===b?void 0:b.url)&&void 0!==l?l:"",richTypes:Object(j.e)(v)},impressionType:"Pin",isPaused:!w,loggingId:v.id,slotIndex:B,viewData:A,viewParameter:k,viewType:N,children:Object(m.g)(v)?Object(h.jsx)(p,{pin:v}):Object(h.jsx)(g.a,{...d,debugImpressionState:w?"started":"paused",onError:T,onLoad:I,pin:v,pinId:n,trackingParameters:{componentType:R,contextLogData:P,slotIndex:B,viewParameter:k,viewType:N}})})}},B6Tf:function(e,t,n){n.d(t,"a",(function(){return me})),n.d(t,"b",(function(){return fe}));var i=n("q1tI"),o=n("b/K5"),r=n("/MKj"),s=n("JW66"),a=n("GBVV"),c=n("yweb"),d=n("/WHw"),l=n("pLLR"),u=n("fZbY"),h=n("oRM1"),b=n("FDmi"),p=n("yaUg"),m=n("n6mq"),f=n("nKUr");function g(e){const t=Object(c.c)(),{body:n,img:i,onClick:o,selected:r,title:s,username:a,valid:d}=e,l=a||n;return Object(f.jsx)(m.f,{marginBottom:4,children:Object(f.jsx)(m.bb,{onTap:o,children:Object(f.jsxs)(m.u,{alignItems:"center",direction:"row",justifyContent:"start",width:"100%",children:[i,Object(f.jsxs)(m.f,{flex:"grow",marginEnd:2,marginStart:3,children:[Object(f.jsx)(m.f,{marginBottom:1,children:Object(f.jsx)(m.cb,{lineClamp:1,weight:"bold",children:s})}),Object(f.jsx)(m.cb,{size:"sm",lineClamp:1,children:l})]}),Object(f.jsx)(m.f,{marginStart:2,children:(u=r,h=d,a?u?Object(f.jsx)(m.w,{accessibilityLabel:t._("Confirmation an invite will be sent","Alt tags on a check box on the board create flow for board invites","Alt tags on a check box on the board create flow for board invites"),color:"red",icon:"check-circle",size:32}):Object(f.jsx)(m.f,{dangerouslySetInlineStyle:{__style:{border:"solid 1px #B5B5B5"}},height:32,rounding:"circle",width:32}):Object(f.jsx)(m.g,{color:"gray",disabled:!!u||Boolean(!h),size:"sm",text:u?t._("Sent","Sent a board collaborator invite","Sent a board collaborator invite"):t._("Invite","Add board collaborator invite","Add board collaborator invite")}))})]})})});var u,h}var j=n("w70y"),O=n("ZE2w");function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function x(e,t,n){const{id:i}=e;return t===n.findIndex(e=>e.id===i)}class S extends i.Component{constructor(...e){super(...e),v(this,"state",{selectedCollaborators:this.props.preselectedCollaborators||[],typeaheadSuggestions:[],value:""}),v(this,"isIdSelected",{}),v(this,"handleTextFieldChange",({value:e})=>{this.setState({value:e})}),v(this,"handleCollaboratorClick",e=>{const{id:t,type:n}=e;this.isIdSelected[t]=!this.isIdSelected[t];const{selectedCollaborators:i}=this.state,o=i.concat([e]),r="email"===n?O.d:O.e;this.props.onSelectedCollaboratorsChange({id:t,resource:r}),this.setState({selectedCollaborators:o})}),v(this,"handleTypeaheadSuggestionsChange",e=>{this.setState({typeaheadSuggestions:e})})}componentDidMount(){this.props.preselectedCollaborators&&this.props.preselectedCollaborators.map(e=>{const{id:t,type:n}=e;this.isIdSelected[t]=!this.isIdSelected[t];const i="email"===n?O.d:O.e;return this.props.onSelectedCollaboratorsChange({id:t,resource:i}),null})}render(){const{value:e}=this.state,{shareSuggestionsResource:{data:t}}=this.props,n=t||[],i=(""===e?this.state.selectedCollaborators.concat(n).filter(x):this.state.selectedCollaborators.concat(this.state.typeaheadSuggestions).concat({type:"email",id:e,valid:Object(u.a)(e)}).concat(n).filter(x)).map(e=>function(e,t,n,i){if("user_share_suggestion"===e.type||"user"===e.type){const i=Object(f.jsx)(b.a,{name:e.title||e.full_name,size:"sm",src:e.image_medium_url||e.image_large_url});return Object(f.jsx)(g,{img:i,onClick:()=>n(e),selected:t,title:e.full_name,username:e.username})}if("email"===e.type){const{id:o,valid:r}=e,s=Object(f.jsx)(m.f,{alignItems:"center",color:"lightGray",display:"flex",height:40,justifyContent:"center",rounding:"circle",width:40,children:Object(f.jsx)(m.w,{accessibilityLabel:i._("Email icon","Email icon on board create modal","Email icon on board create modal"),color:"darkGray",icon:"envelope",size:20})}),a=Object(p.a)(i._("Email {{ email }}"),{email:o});let c,d;return t?(c=i._("Done!","Text that lets the user know we sent the board invite email","Text that lets the user know we sent the board invite email"),d=()=>{}):(c=r?i._("Click to send!","Text that lets the user know they can successfully send a board invite email","Text that lets the user know they can successfully send a board invite email"):i._("Keep typing!","Text that lets a user know the email they are typing is not valid yet","Text that lets a user know the email they are typing is not valid yet"),d=()=>r?n(e):void 0),Object(f.jsx)(g,{body:c,img:s,onClick:d,selected:t,title:a,valid:r})}}(e,this.isIdSelected[e.id],this.handleCollaboratorClick,this.props.i18n)).map((e,t)=>Object(f.jsx)("li",{children:e},t));return Object(f.jsxs)(m.u,{alignItems:"stretch",justifyContent:"start",direction:"column",height:"100%",children:[Object(f.jsx)(m.f,{paddingX:3,paddingY:2,children:Object(f.jsx)(m.cb,{size:"sm",children:this.props.i18n._("Add collaborators (optional)","Optional field to add collaborators to a board on board create","Optional field to add collaborators to a board on board create")})}),Object(f.jsx)(m.f,{marginBottom:4,marginTop:2,paddingX:3,width:"100%",children:Object(f.jsx)(m.f,{flex:"grow",children:Object(f.jsx)(h.a,{onTypeaheadSuggestionsChange:this.handleTypeaheadSuggestionsChange,resourceName:"ShareSuggestionsTypeaheadResource",value:e,children:Object(f.jsx)(m.Q,{accessibilityLabel:this.props.i18n._("Search for collaborators by name or email"),id:"CollaboratorInviteSearchField",onChange:this.handleTextFieldChange,placeholder:this.props.i18n._("Search by name or email"),size:"lg",value:e})})})}),Object(f.jsx)(m.f,{overflow:"scrollY",paddingX:3,children:Object(f.jsx)("ul",{children:i})})]})}}function y(e){const t=Object(c.c)(),n=Object(j.a)({name:"ShareSuggestionsResource",noCache:!0});return Object(f.jsx)(S,{...e,i18n:t,shareSuggestionsResource:n})}var _=Object(d.a)((function({createBoardError:e,inputName:t,nameValidatorErrors:n,onBoardCreate:o,onCancel:r,onChangeBoardName:d,onChangeBoardPrivacy:u,onInvite:h,privacy:b,preselectedCollaborators:p,saving:g,showTitle:j,isAdAccountOwner:O}){const v=Object(c.c)(),{isRTL:x}=Object(l.d)(),S=0===n.length,_=b===s.a.BoardPrivacy.SECRET;return Object(f.jsx)(m.f,{color:"white",height:"100%",left:!0,position:"absolute",top:!0,width:"100%",children:Object(f.jsx)("form",{onSubmit:e=>{e.preventDefault(),o()},style:{height:"100%"},children:Object(f.jsxs)(m.u,{alignItems:"stretch",justifyContent:"start",direction:"column",height:"100%",children:[j&&Object(f.jsx)(m.f,{display:"flex",marginTop:3,paddingX:6,paddingY:3,children:Object(f.jsx)(m.v,{size:"sm",children:v._("Create board")})}),Object(f.jsxs)(m.f,{padding:3,children:[Object(f.jsx)(m.f,{marginBottom:2,children:Object(f.jsx)(m.z,{htmlFor:"boardEditName",children:Object(f.jsx)(m.cb,{size:"sm",children:v._("Name")})})}),Object(f.jsx)(m.f,{children:Object(f.jsx)(m.eb,{errorMessage:n.join(", "),id:"boardEditName",name:"boardName",onChange:({value:e})=>d(e),placeholder:v._('Like "Places to Go" or "Recipes to Make"'),size:"lg",value:t})})]}),O&&Object(f.jsxs)(i.Fragment,{children:[Object(f.jsxs)(m.f,{padding:3,children:[Object(f.jsx)(m.f,{marginBottom:2,children:Object(f.jsx)(m.z,{htmlFor:"secret",children:Object(f.jsx)(m.cb,{size:"sm",children:v._("Secret","secret board","secret board")})})}),Object(f.jsx)(m.f,{children:Object(f.jsx)(m.X,{id:"secret",onChange:u,switched:_})})]}),Object(f.jsx)(m.u,{alignItems:"stretch",justifyContent:"start",flex:"grow",overflow:"hidden",children:Object(f.jsx)(m.f,{width:"100%",children:Object(f.jsx)(y,{onSelectedCollaboratorsChange:h,preselectedCollaborators:p})})})]}),!O&&Object(f.jsx)(i.Fragment,{children:Object(f.jsxs)(m.f,{padding:3,children:[Object(f.jsx)(m.f,{marginBottom:2,children:Object(f.jsx)(m.z,{htmlFor:"protected",children:Object(f.jsx)(m.cb,{size:"sm",children:v._("Protected board (not listed on user's profile)","protected board","protected board")})})}),Object(f.jsx)(m.f,{children:Object(f.jsx)(m.X,{disabled:!0,id:"protected",onChange:()=>{},switched:!0})})]})}),Object(f.jsxs)(m.f,{bottom:!0,color:"white",dangerouslySetInlineStyle:{__style:{boxShadow:"0px 0px 8px rgba(0, 0, 0, 0.1)",borderBottomLeftRadius:"32px",borderBottomRightRadius:"32px"}},display:"flex",justifyContent:"between",left:x,paddingX:4,paddingY:2,position:"absolute",right:!x,width:720,children:[Object(f.jsx)(m.g,{onClick:r,text:v._("Cancel","cancel board create","cancel board create")}),Object(f.jsxs)(m.u,{alignItems:"stretch",justifyContent:"end",children:[!!e&&Object(f.jsx)(m.f,{paddingX:2,children:Object(f.jsx)(m.cb,{align:"center",color:"red",size:"md",weight:"bold",children:e})}),Object(f.jsx)(a.b,{disabled:!t.trim()||!S||!!e||g,submitting:g,text:v._("Create","create a new board","create a new board")})]})]})]})})})})),w=n("6A0I"),C=n("qyR9"),I=n("0BOE");class T extends i.Component{constructor(...e){var t,n,i;super(...e),i=e=>{const{board:t,sectionsResource:{data:n}}=this.props;return e.length>=2?[{items:Object(I.a)([t],e),customProps:{inSectionSelection:!0}},{items:Object(I.a)(null!=n?n:[],e,"title")}]:[{items:[t],customProps:{inSectionSelection:!0}},{items:null!=n?n:[]}]},(n="getSections")in(t=this)?Object.defineProperty(t,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[n]=i}render(){const{sectionsResource:{error:e,isLoaded:t},boardSavedTo:n,isSelectMode:i,onSectionCreate:o,onSectionSelected:r,pinId:s}=this.props;return Object(f.jsx)(C.a,{isSelectMode:i,boardSavedTo:n,createButtonLabel:this.props.i18n._("Add section","Button for creating a board section","Button for creating a board section"),hasLoadError:!!e,isLoaded:t,getSections:this.getSections,onCreate:o,onSelected:r,pinId:s})}}function R(e){const t=Object(c.c)(),n=Object(j.a)({name:"BoardSectionsRepinResource",options:{board_id:e.board.id}});return Object(f.jsx)(T,{...e,i18n:t,sectionsResource:n})}var P=n("Wer7"),E=n("U4JR"),B=n("xkL+");function A(e,t,n){return{...e?{pin_id:e}:Object.freeze({}),...t?{username:t}:Object.freeze({}),...n?{advertiser_id:n,filter:"protected"}:Object.freeze({}),field_set_key:"board_picker",limit:undefined,shortlist_suggestions:2}}class k extends i.Component{constructor(...e){var t,n,i;super(...e),i=e=>{const{boardResource:{data:t}}=this.props;if(!t)return[];const{all_boards:n,boards_shortlist:i}=t,o=(e=>{const t=[],n=[];return e.forEach(e=>{var i;null!==(i=e.name)&&void 0!==i&&i.match(/^\d/)?n.push(e):t.push(e)}),[...t,...n]})(n);return o.length<=3?[{items:o}]:e.length>=2?[{items:Object(I.a)(o,e)}]:[i.length?{items:i,title:this.props.i18n._("Top choices")}:{items:[]},{items:o,title:this.props.i18n._("All boards","title for board picker all boards section","title for board picker all boards section")}]},(n="getSections")in(t=this)?Object.defineProperty(t,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[n]=i}render(){const{boardResource:{data:e,error:t,isLoaded:n},boardSavedTo:i,isSelectMode:o,onBoardCreate:r,onBoardSelected:s,pinId:a}=this.props,c=n&&!!e&&e.all_boards.length<=3;return Object(f.jsx)(C.a,{isSelectMode:o,boardSavedTo:i,hasLoadError:!!t,hasLowBoardCount:c,isLoaded:n,getSections:this.getSections,onCreate:r,onSelected:s,pinId:a})}}function N(e){const t=Object(c.c)(),n=Object(B.b)(),i=Object(r.useSelector)(({advertiser:e})=>{if(n.isAuth&&e&&e.owner_user_id!==n.id)return e.id}),o=Object(r.useSelector)(({advertiser:e})=>{if(n.isAuth&&e&&e.owner_user_id!==n.id)return e.owner_user_id}),s=Object(j.a)({name:"BoardPickerBoardsResource",options:A(e.pinId,o,i)});return Object(f.jsx)(k,{...e,boardResource:s,i18n:t})}function D(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class M extends i.Component{constructor(...e){super(...e),D(this,"state",{inviteQueue:{},newName:"",selectedSectionBoard:this.props.boardWithSection||null,showCreate:this.props.showCreate||!1}),D(this,"close",()=>{const{selectedSectionBoard:e,showCreate:t}=this.state,{onClose:n}=this.props;t&&e?this.setState({showCreate:!1},this.manageModalTitle):e?this.setState({selectedSectionBoard:null},this.manageModalTitle):n()}),D(this,"sendInvites",e=>{const{inviteQueue:t}=this.state;Object.keys(t).forEach(n=>{t[n].resource(e.id,[n])})}),D(this,"handleInvite",e=>{const{inviteQueue:t}=this.state;if(t[e.id]){const n={...t};delete n[e.id],this.setState({inviteQueue:n})}else{const n=Object.assign({},t,{[e.id]:e});this.setState({inviteQueue:n})}}),D(this,"handleBoardCreate",e=>{const{onBoardCreated:t}=this.props;this.handleBoardSave(e,!0),t&&t(e)}),D(this,"handleBoardSave",(e,t)=>{const{selectedSectionBoard:n}=this.state,{onBoardSave:i,invalidatePinBetterSaveResource:o,invalidateResource:r}=this.props;if(r(),o(),n&&"board_section"===e.type){return i(n,e,t)}const s=e,{section_count:a=0}=s;!n&&"number"==typeof a&&a>0?this.setState({selectedSectionBoard:s},this.manageModalTitle):(this.sendInvites(e),i(s,void 0,t))}),D(this,"handleCreate",e=>t=>{t=t||"",this.setState({newName:t,showCreate:!0},this.manageModalTitle);const n=e?13105:13025,i=e?10306:249;Object(E.b)(101,{component:n,element:i})}),D(this,"manageModalTitle",()=>{const{setModalTitle:e}=this.props,{selectedSectionBoard:t,showCreate:n}=this.state;e&&e(n&&t?this.props.i18n._("Add section","Repin title for making a board section","Repin title for making a board section"):n&&!t?this.props.i18n._("Create board","Repin title for making a new board","Repin title for making a new board"):t&&!n?this.props.i18n._("Choose section","Repin title for choosing a board section","Repin title for choosing a board section"):this.props.i18n._("Choose board","Repin title for choosing a board","Repin title for choosing a board"))})}render(){const{boardSavedTo:e,isRepin:t,isSelectMode:n,onToggleFlyout:i,pinId:o,preselectedCollaborators:r,setModalTitle:s,suggestedBoardTitle:a}=this.props,{newName:c,selectedSectionBoard:d,showCreate:l}=this.state,u=!!d,h=!s;return Object(f.jsxs)(m.f,{display:"flex",position:"relative",width:"100%",children:[!l&&Object(f.jsx)(m.f,{direction:"column",display:"flex",marginTop:4,width:"100%",children:d?Object(f.jsx)(R,{board:d,boardSavedTo:e,isSelectMode:n,onSectionCreate:this.handleCreate(u),onSectionSelected:this.handleBoardSave}):Object(f.jsx)(N,{boardSavedTo:e,isSelectMode:n,onBoardCreate:this.handleCreate(u),onBoardSelected:this.handleBoardSave,pinId:o})}),l&&!d&&Object(f.jsx)(_,{onCancel:this.close,onCreate:this.handleBoardCreate,onInvite:this.handleInvite,onToggleFlyout:i,pinId:o,prefilledName:c||a,preselectedCollaborators:r,showTitle:h}),l&&d&&Object(f.jsx)(w.a,{board:d,completeCreateSectionAction:this.handleBoardSave,initialName:c,isRepin:t,onClearModal:this.close,showTitle:h})]})}}var L=Object(r.connect)(null,(function(e,t){return{invalidateResource:()=>{e(Object(P.f)("BoardPickerBoardsResource",A(t.pinId)))},invalidatePinBetterSaveResource:()=>{e(Object(P.f)("BoardPickerBoardsResource",{field_set_key:"board_picker"}))}}}))((function(e){const t=Object(c.c)();return Object(f.jsx)(M,{...e,i18n:t})})),U=n("TgLd"),F=n("v+PR"),H=n("1inl"),z=n("K316"),W=n("TvzZ"),q=n("Ye/N");const G="publish_actions",V={checkFbTimelinePermission:function(e){Object(W.default)((function(t){t.api("/me/permissions",t=>{const n=t.data;let i=!1;if(n){i=!!n.find(e=>e.permission===G&&"granted"===e.status)}i?e.success&&e.success():e.error&&e.error()})}),z.a)},fbConnectedAccountMatchesLoggedInAccount:function(e,t){if(!t)return!0;const n=e.getAuthResponse();return!n||t===n.userID},maybeRequestFbTimelinePermission:function(e,t){Object(W.default)(n=>{if(!V.fbConnectedAccountMatchesLoggedInAccount(n,t))return H.a.showError(q.a._("Oops! Your account is linked to a different Facebook account than the one you're logged into now.")),e.error&&e.error(),void(e.complete&&e.complete());V.checkFbTimelinePermission({success(){e.success&&e.success(),e.complete&&e.complete()},error(){V.fbLogin(e)}})},z.a)},fbLogin:function(e){Object(W.default)(t=>{t.login(t=>{t.authResponse?V.checkFbTimelinePermission(e):e.error&&e.error(),e.complete&&e.complete()},{scope:G})},z.a)}};var K=V,Y=n("G35+"),X=n("mBfy");function Q({onSocialConnect:e}){const t=Object(c.c)(),n=Object(B.b)(),{data:o,isLoaded:r}=Object(j.a)({name:"UserResource",options:{user_id:n&&n.isAuth?n.id:"",field_set_key:"social_connect"}}),[s,a]=Object(i.useState)(!!(r&&o&&o.facebook_publish_stream_enabled)),[d,l]=Object(i.useState)(!!(r&&o&&o.twitter_publish_enabled));if(Object(i.useEffect)(()=>{r&&o&&(a(!!o.facebook_publish_stream_enabled),l(!!o.twitter_publish_enabled))},[o,r]),!o)return null;const{connected_to_facebook:u,twitter_url:h}=o,b=t=>{a(t),X.default.set("facebook_publish_stream_enabled",t),e(Y.a.FACEBOOK,t)};return!(!u&&!h)&&Object(f.jsxs)(m.f,{display:"flex",padding:2,children:[u&&Object(f.jsxs)(m.f,{display:"flex",alignItems:"center",marginStart:2,children:[Object(f.jsx)(m.k,{checked:s,id:"share_facebook",onChange:()=>{s?b(!1):K.maybeRequestFbTimelinePermission({success:()=>b(!0),error:()=>b(!1)})},size:"sm"}),Object(f.jsx)(m.z,{htmlFor:"share_facebook",children:Object(f.jsx)(m.f,{marginStart:2,children:Object(f.jsx)(m.cb,{children:t._("Post to Facebook")})})})]}),h&&Object(f.jsxs)(m.f,{display:"flex",alignItems:"center",marginStart:5,children:[Object(f.jsx)(m.k,{checked:d,id:"share_twitter",onChange:()=>{const t=!d;l(t),e(Y.a.TWITTER,t)},size:"sm"}),Object(f.jsx)(m.z,{htmlFor:"share_twitter",children:Object(f.jsx)(m.f,{marginStart:2,children:Object(f.jsx)(m.cb,{children:t._("Post to Twitter")})})})]})]})}var Z=n("Sihc");var $=({board:e,completeCreateSectionAction:t,height:n,onClose:o,pinImport:s,url:a,width:d})=>{const l=Object(c.c)(),u=Object(r.useDispatch)(),[h,b]=Object(i.useState)(""),[p,g]=Object(i.useState)(!1),[j,O]=Object(i.useState)(null);return Object(f.jsx)(U.b,{accessibilityModalLabel:l._("Repin modal","save.pinToBoard.modal.label","Accessibility label on modal"),heading:Object(f.jsx)(m.f,{padding:8,children:Object(f.jsx)(m.u,{alignItems:"center",children:Object(f.jsx)(m.f,{width:"66%",marginStart:"auto",children:Object(f.jsxs)(m.u,{justifyContent:"between",children:[Object(f.jsx)(m.v,{size:"md",children:l._("Add section","sectionCreateModal.title","Title in the add section modal")}),Object(f.jsx)(m.x,{icon:"cancel",accessibilityLabel:l._("Close","sectionCreateModal.closeButton","close section create modal button"),size:"md",iconColor:"darkGray",onClick:o})]})})})}),footer:Object(f.jsx)(m.u,{children:Object(f.jsx)(m.f,{marginStart:"auto",children:Object(f.jsx)(m.g,{fullWidth:!0,text:l._("Add","sectionCreateModal.add.button","add a new section"),color:"red",onClick:()=>{e&&(g(!0),u(Object(Z.a)({boardId:e.id,name:h.trim(),pinImport:s},l)).then(n=>{t(e,n,!1)}).catch(e=>{O(e.message||e.message_detail)}).finally(()=>{g(!1)}))},disabled:p||!h.trim()||!!j,size:"lg"})})}),onDismiss:o,size:"sm",children:Object(f.jsx)(m.f,{padding:8,children:Object(f.jsxs)(m.u,{children:[Object(f.jsx)(m.D,{rounding:4,height:n,width:d,children:Object(f.jsx)(m.y,{alt:"",fit:"cover",src:a||"",naturalHeight:null!=n?n:1,naturalWidth:null!=d?d:1})}),Object(f.jsx)(m.f,{marginStart:8,dangerouslySetInlineStyle:{__style:{width:d?`calc(100% - ${d}px)`:"100%"}},children:Object(f.jsx)(m.eb,{id:"sectionEditName",onChange:e=>{b(e.value)},placeholder:l._('Like "Lighting"',"sectionCreateModal.boardSection.name","Placeholder for board section name"),label:l._("Name","section.create.label","label text for section input"),size:"lg",type:"text",value:h})})]})})})};function J(){const e=Object(c.c)();return Object(f.jsxs)(m.u,{alignItems:"center",direction:"column",justifyContent:"center",children:[Object(f.jsx)(m.U,{accessibilityLabel:e._("Pins being saved to new sections","save.pin-to-board.PinToBoard.SectionSuggestions.SavingView","accessibility label on spinner"),show:!0}),Object(f.jsx)(m.f,{paddingY:2,children:Object(f.jsx)(m.v,{children:e._("Hold, please...","save.pin-to-board.PinToBoard.SectionSuggestions.SavingView","Heading on modal while saving pins")})}),Object(f.jsx)(m.cb,{children:e._("We're grouping the ideas you picked into sections. This will help organize all your ideas!","save.pin-to-board.PinToBoard.SectionSuggestions.SavingView","Text explaining new pins are being saved")})]})}var ee=n("82UD");function te({index:e,pin:t,sectionName:n}){const o=t.id,r=Object(i.useContext)(le),[s,a]=Object(i.useState)(!1),c=Object(i.useCallback)(({event:e})=>{e.preventDefault(),e.stopPropagation(),r({type:s?"unselect":"select",payload:{sectionName:n,pinId:o}}),a(!s)},[o,s]);return Object(f.jsx)(m.bb,{onTap:c,rounding:4,children:Object(f.jsx)(ee.default,{attributionOption:"hide",blockClickEvents:!0,pin:t,pinId:t.id,pinImageCrop:"none",saveButtonOptions:{type:"none"},selectionState:s?"selected-image-only":"deselected-image-only",surface:"SectionSuggestedPins",trackingParameters:{slotIndex:e}})})}var ne=Object(i.memo)((function({sectionSuggestion:e,showSpinner:t}){const n=Object(c.c)(),o=Object(i.useRef)(),r=Object(j.a)({name:"BatchP2PResource",options:{clientType:"84",page_size:10,pinIds:e.pins.map(e=>e.id)},noCache:!0});return Object(f.jsxs)(i.Fragment,{children:[Object(f.jsx)(m.u,{alignItems:"stretch",justifyContent:"center",width:"100%",children:Object(f.jsx)(m.U,{accessibilityLabel:n._("Loading pins","save.pin-to-board.PinToBoard.SectionSuggestions.SectionPinsSelection","Accessibility label on a loading spinner"),show:t&&r.isFetching})}),r.data&&Object(f.jsx)(m.f,{paddingY:4,paddingX:8,children:Object(f.jsx)(m.v,{align:"start",size:"sm",children:e.name})}),Object(f.jsx)(m.f,{ref:o,children:r.data&&o&&o.current&&Object(f.jsx)(m.E,{columnWidth:152,comp:({data:t,itemIdx:n})=>Object(f.jsx)(te,{index:n,pin:t,sectionName:e.name}),gutterWidth:16,items:r.data||[],loadItems:()=>{},scrollContainer:()=>o.current})})]})}),(e,t)=>e.sectionSuggestion.id===t.sectionSuggestion.id);function ie({canSubmit:e,handleClose:t,handleSubmit:n,sectionSuggestions:o}){const r=Object(c.c)();Object(i.useEffect)(()=>{const e=[];o.forEach(t=>e.push(t.name)),Object(E.b)(13,{suggested_section_names_viewed:e,view:1,viewParameter:3461})},[o]);return Object(f.jsx)(i.Fragment,{children:Object(f.jsxs)(m.f,{width:"100%",children:[Object(f.jsx)(m.f,{minHeight:"100%",marginBottom:12,width:"100%",children:o.map((e,t)=>Object(f.jsx)(m.f,{marginBottom:4,children:Object(f.jsx)(ne,{sectionSuggestion:e,showSpinner:0===t})},e.name))}),Object(f.jsx)(m.f,{bottom:!0,color:"white",dangerouslySetInlineStyle:{__style:{boxShadow:"0px 0px 8px rgba(0, 0, 0, 0.1)",position:"sticky"}},display:"flex",justifyContent:"end",padding:4,width:720,children:Object(f.jsx)(m.g,{color:e?"red":"gray",size:"lg",text:e?r._("Next","save.pin-to-board.PinToBoard.SectionPinsWrapper","Button to submit form selections"):r._("Skip","save.pin-to-board.PinToBoard.SectionPinsWrapper","Button to submit form selections"),onClick:()=>{e?n():t()}})})]})})}function oe({handleClose:e,handleSubmit:t,suggestions:n}){const o=Object(c.c)(),[r,s]=Object(i.useState)({}),a=!!Object.keys(r).length;return Object(f.jsxs)(m.f,{children:[Object(f.jsx)(m.f,{display:"flex",alignItems:"center",dangerouslySetInlineStyle:{__style:{height:"calc(100% - 88px)"}},children:Object(f.jsx)(m.f,{display:"flex",wrap:!0,height:360,paddingX:6,children:n.map(e=>Object(f.jsx)(m.f,{paddingX:1,height:160,children:Object(f.jsx)(m.bb,{onTap:()=>{const t={...r};t[e.name]?delete t[e.name]:t[e.name]=e,s(t)},rounding:6,children:Object(f.jsx)(m.f,{rounding:7,dangerouslySetInlineStyle:{__style:{border:r[e.name]?"2px solid #111":"2px solid white",padding:"2px"}},children:Object(f.jsxs)(m.f,{height:160,width:152,position:"relative",rounding:6,children:[Object(f.jsx)(m.D,{rounding:6,height:160,width:152,children:Object(f.jsx)(m.y,{alt:e.name,fit:"cover",naturalHeight:e.images["236x"].height,naturalWidth:e.images["236x"].width,src:e.images["236x"].url})}),Object(f.jsx)(m.f,{alignItems:"center",dangerouslySetInlineStyle:{__style:{background:"rgba(0, 0, 0, 0.3)"}},display:"flex",height:160,justifyContent:"center",left:!0,paddingX:5,position:"absolute",rounding:6,top:!0,width:152,children:Object(f.jsx)(m.v,{align:"center",color:"white",size:"sm",children:e.name})})]})})})},e.name))})}),Object(f.jsx)(m.f,{display:"flex",width:"100%",justifyContent:"end",padding:5,children:Object(f.jsx)(m.g,{color:a?"red":"gray",size:"lg",text:a?o._("Next","save.pin-to-board.SectionSuggestionPicker","Button to submit form selections"):o._("Skip","save.pin-to-board.SectionSuggestionPicker","Button to submit form selections"),onClick:()=>{a?t(Object.values(r)):e()}})})]})}var re=n("M1Uz"),se=n("6G9P"),ae=n("0S8y"),ce=n("EC67"),de=n("nGHF");const le=Object(i.createContext)();function ue(e,t){const{sectionName:n,pinId:i}=t.payload,o=[...e[n]||[]];switch(t.type){case"select":return{...e,[n]:[...o,i]};case"unselect":const t=o.indexOf(i);if(o.splice(t,1),!o.length){const t={...e};return delete t[n],t}return{...e,[n]:o};default:throw new Error("Unsupported action received by PinSelectionReducer")}}function he({board:e,handleClose:t,setModalTitle:n,suggestions:o,viewer:s}){const a=Object(c.c)(),[d,l]=Object(i.useState)("sections"),[u,h]=Object(i.useState)([]),[b,p]=Object(i.useState)([]),[m,g]=Object(i.useReducer)(ue,{}),{showOneToast:j}=Object(de.b)(),O=Object(r.useDispatch)(),v=Object(ce.h)(),x=Object(i.useRef)(null);Object(i.useEffect)(()=>()=>{x.current&&clearTimeout(x.current)},[]),Object(i.useEffect)(()=>{const e=[];o.forEach(t=>e.push(t.name)),p(e)},[o]);const S=()=>{Object(E.b)(101,{component:20,view:52})},y=()=>{t(),j(({onHide:t})=>{var n;return Object(f.jsx)(re.a,{duration:me,onHide:t,text:Object(se.a)(a,e.name),href:e.url,imageUrl:null!==(n=e.image_cover_url)&&void 0!==n?n:"",onClick:S})}),Object(E.b)(101,{element:1150,view:1,viewParameter:3460,suggested_section_names:b})};return{sections:Object(f.jsx)(oe,{handleClose:y,handleSubmit:e=>{h(e),l("pins"),n&&(Object(ae.c)({user:s})?n(a._("Great! Now pick a few ideas to add to your board's new section.","save.pin-to-board.PinToBoard.SectionSuggestions.SectionSuggestionContainerNewUser","Modal title for choosing ideas for a new board")):n(a._("Great! Now pick some ideas to start off with.","save.pin-to-board.PinToBoard.SectionSuggestions.SectionSuggestionContainer","Modal title for choosing ideas for a new board")));const t=[];e.forEach(e=>t.push(e.name)),Object(E.b)(101,{element:96,suggested_section_names_selected:t,suggested_section_names_viewed:b,view:1,viewParameter:3460})},suggestions:o}),pins:Object(f.jsx)(le.Provider,{value:g,children:Object(f.jsx)(ie,{canSubmit:!!Object.keys(m).length,handleClose:y,handleSubmit:()=>{let t=0;l("saving"),n&&n(null);const i=u.reduce((e,t)=>(e[t.name]=null,e),{});let o=0;const r=[];Object.entries({...i,...m}).forEach(([n,i])=>{o+=Array.isArray(i)&&i.length,r.push({[n]:i}),O(Object(Z.a)({boardId:e.id,initialPinIds:i,name:n},a)).then(()=>{t+=1,t===u.length&&(x.current=setTimeout(()=>{var t;v.push(null!==(t=e.url)&&void 0!==t?t:"")},1500),Object(E.b)(101,{element:76,number_pins_selected:o,number_sections_selected:u.length,selected_pin_ids:JSON.stringify(r),suggested_section_names:b,view:1,viewParameter:3460}))})})},sectionSuggestions:u})}),saving:Object(f.jsx)(J,{})}[d]}var be=n("Yo6N");function pe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const me=4e3,fe={LOADING:"loading",SUCCESS:"success"};class ge extends i.PureComponent{constructor(...e){super(...e),pe(this,"state",{isFlyoutOpen:!1,isSavingPin:!1,newBoard:null}),pe(this,"pinImageRef",Object(i.createRef)()),pe(this,"unmounted",!1),pe(this,"handleSavePinToBoard",(e,t,n)=>{const{handleSaveToBoard:i,sectionSuggestions:o,setModalTitle:r,viewer:s}=this.props;i(e,t,n),n&&(this.setState({isSavingPin:!0,newBoard:e}),o&&o.length>0&&r&&(Object(ae.c)({user:s})?r(this.props.i18n._("You can keep your boards organized with sections. Try adding a section to your new board now!","save.pin-to-board.PinToBoard.SectionPickerModalTitleNewUser","Modal title for selection recommended sections for a new board")):r(this.props.i18n._("Let's build out your new board! What topics will it include?","save.pin-to-board.PinToBoard.SectionPickerModalTitle","Modal title for selection recommended sections for a new board"))))}),pe(this,"handleToggleFlyout",()=>this.setState({isFlyoutOpen:!this.state.isFlyoutOpen})),pe(this,"safeSetState",(e,t)=>{this.unmounted?t&&t():this.setState(e,t)}),pe(this,"close",()=>{const{isFlyoutOpen:e}=this.state,{handleAbort:t}=this.props;e||t()}),pe(this,"dismissModal",e=>{const{dismissModal:t}=this.props;t&&t()})}componentWillUnmount(){this.unmounted=!0}render(){const{boardSavedTo:e,boardWithSection:t,color:n,displaySuccessAnimation:r,handleNewBoardAnimationCompletion:s,handleSocialConnectSet:a,isInModal:c,newPin:d,pin:l,preselectedCollaborators:u,onBoardCreated:h,sectionSuggestions:b,sensitiveContentNotice:p,setModalTitle:g,showCreate:j,shouldRenderContent:O,suggestedBoardTitle:v,updateDescription:x,viewer:S}=this.props;if(!l||!l&&!l.resourceLoaded||!O)return null;const{isSavingPin:y,newBoard:_}=this.state;if(j&&t){var w;const{url:e,width:n,height:i}=(null===(w=l.images)||void 0===w?void 0:w["236x"])||{};return Object(f.jsx)($,{board:t,url:e,height:i,width:n,onClose:this.close,completeCreateSectionAction:this.handleSavePinToBoard})}let C=null;d&&d.board&&(C=d.board.name);const I=p&&p.title||this.props.modalTitle,T=p?Object(f.jsx)(be.a,{inModal:!0,notices:[p]}):Object(f.jsx)(m.u,{alignItems:"stretch",height:"calc(90vh - 97px)",justifyContent:"center",maxHeight:"703px",width:"100%",children:y&&_&&b&&b.length>0?Object(f.jsx)(he,{board:_,handleClose:this.close,setModalTitle:g,suggestions:b,viewer:S}):Object(f.jsxs)(i.Fragment,{children:[Object(f.jsxs)(m.f,{color:"white",display:"flex",height:"100%",overflow:"hidden",position:"relative",rounding:2,width:"100%",children:[Object(f.jsxs)(m.u,{alignItems:"stretch",direction:"column",justifyContent:"between",width:"40%",children:[Object(f.jsx)(m.f,{alignItems:"center",direction:"column",display:"flex",flex:"grow",justifyContent:"start",marginTop:3,children:Object(f.jsx)(F.a,{color:n,pin:l,pinImageRef:this.pinImageRef,updateDescription:x})}),Object(f.jsx)(Q,{onSocialConnect:a})]}),Object(f.jsx)(m.u,{alignItems:"stretch",width:"60%",children:Object(f.jsx)(L,{boardSavedTo:e,boardWithSection:t,isRepin:!0,onBoardCreated:h,onBoardSave:this.handleSavePinToBoard,onClose:this.close,onToggleFlyout:this.handleToggleFlyout,pinId:l.id,preselectedCollaborators:u,setModalTitle:c?g:void 0,showCreate:j,suggestedBoardTitle:v})})]}),r&&Object(f.jsx)(o.a,{onDismiss:()=>{s(),this.dismissModal()},pin:l,pinImageRef:this.pinImageRef,selectedBoardName:C})]})});return c?Object(f.jsx)(U.b,{accessibilityModalLabel:I||this.props.i18n._("Repin modal","save.pin-to-board.PinToBoard.PinToBoard","Accessibility label on modal"),heading:I,onDismiss:this.close,size:"md",children:T}):T}}pe(ge,"defaultProps",{pwtAuxData:{}});t.c=function(e){const t=Object(c.c)(),n=Object(B.b)();return Object(f.jsx)(ge,{...e,i18n:t,viewer:n})}},CMye:function(e,t,n){var i=n("GoyQ");e.exports=function(e){return e==e&&!i(e)}},DzJC:function(e,t,n){var i=n("sEfC"),o=n("GoyQ");e.exports=function(e,t,n){var r=!0,s=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return o(n)&&(r="leading"in n?!!n.leading:r,s="trailing"in n?!!n.trailing:s),i(e,t,{leading:r,maxWait:t,trailing:s})}},EuRG:function(e,t,n){function i(e,t){return{type:"SEARCH_PIN_CLOSEUP_VIEWED",payload:{pinId:e,query:t}}}function o(e){return{type:"SEARCH_QUERY_STARTED",payload:{query:e}}}function r(e){return{type:"SEARCH_QUERY_INVALIDATED",payload:{query:e}}}n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return r}))},GDhZ:function(e,t,n){var i=n("wF/u"),o=n("mwIZ"),r=n("hgQt"),s=n("9ggG"),a=n("CMye"),c=n("IOzZ"),d=n("9Nap");e.exports=function(e,t){return s(e)&&a(t)?c(d(e),t):function(n){var s=o(n,e);return void 0===s&&s===t?r(n,e):i(t,s,3)}}},"H/Lk":function(e,t,n){n.d(t,"a",(function(){return i}));const i=(e,t,n)=>({type:"MOST_RECENT_BOARD",payload:{id:e,name:t,url:n}})},IOzZ:function(e,t){e.exports=function(e,t){return function(n){return null!=n&&(n[e]===t&&(void 0!==t||e in Object(n)))}}},IWTy:function(e,t,n){var i=n("yue5");e.exports=function(e,t,n){for(var o=-1,r=e.criteria,s=t.criteria,a=r.length,c=n.length;++o<a;){var d=i(r[o],s[o]);if(d)return o>=c?d:d*("desc"==n[o]?-1:1)}return e.index-t.index}},J8m7:function(e,t,n){n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return r})),n.d(t,"e",(function(){return s})),n.d(t,"f",(function(){return a})),n.d(t,"g",(function(){return c})),n.d(t,"h",(function(){return d})),n.d(t,"i",(function(){return l})),n.d(t,"j",(function(){return u})),n.d(t,"m",(function(){return h})),n.d(t,"n",(function(){return b})),n.d(t,"o",(function(){return p})),n.d(t,"p",(function(){return m})),n.d(t,"q",(function(){return f})),n.d(t,"r",(function(){return g})),n.d(t,"t",(function(){return j})),n.d(t,"u",(function(){return O})),n.d(t,"v",(function(){return v})),n.d(t,"w",(function(){return x})),n.d(t,"x",(function(){return S})),n.d(t,"y",(function(){return y})),n.d(t,"z",(function(){return _})),n.d(t,"A",(function(){return w})),n.d(t,"C",(function(){return C})),n.d(t,"E",(function(){return I})),n.d(t,"D",(function(){return T})),n.d(t,"F",(function(){return R})),n.d(t,"G",(function(){return P})),n.d(t,"s",(function(){return E})),n.d(t,"k",(function(){return B})),n.d(t,"l",(function(){return A})),n.d(t,"B",(function(){return k})),n.d(t,"H",(function(){return N})),n.d(t,"b",(function(){return D}));const i=101,o=93,r=116,s=9,a=8,c=16,d=12,l=3,u=18,h=105,b=79,p=78,m=77,f=76,g=1402,j=85,O=82,v=88,x=1201,S=86,y=30,_=84,w=83,C=2901,I=2904,T=2905,R=95,P=19,E=113,B=91,A=2501,k=3050,N=[a,s],D=new Map([[1,"INVALID_PARAMETERS"],[100,"INVALID_NETWORK_ACCESS_TOKEN"],[h,"FACEBOOK_ACCOUNT_NOT_LINKED"],[d,"API_SERVER_ERROR"],[1202,"LOGIN_MFA_TOKEN_INVALID"],[1203,"MFA_CONNECTION_ERROR"],[13,"API_DOWN"],[181,"GPLUS_CONNECTION_ERROR"],[14,"API_SERVER_SPAM_CONTENT"],[c,"API_REQUEST_TIMEOUT"],[50,"API_ERROR_PIN_NOT_FOUND"],[m,"INVALID_PASSWORD_FB_USER"],[p,"INVALID_PASSWORD_ERROR_CODE"],[b,"INVALID_EMAIL_ERROR_CODE"],[80,"INVALID_EMAIL_OR_PASSWORD"],[O,"LOGIN_DEACTIVATED_USER"],[w,"LOGIN_POLICY_VIOLATION_USER"],[j,"AUTO_PASSWORD_RESET_ERROR_CODE"],[S,"LOGIN_PANICKED_USER"],[87,"LOGIN_SOFT_BANNED_USER"],[o,"API_ERROR_UNDERAGE_REGISTER_ATTEMPT"],[r,"API_ERROR_OVERAGE_REGISTER_ATTEMPT"],[99,"LOGIN_PASSWORD_NOT_CREATED"],[a,"API_LIMIT_EXCEEDED_ERROR"],[s,"API_EVENT_BLOCKED_ERROR"],[P,"USER_IN_SAFE_MODE"],[_,"LOGIN_VOLUNTARILY_DEACTIVATED_USER"],[j,"LOGIN_BAD_PASSWORD_ASK_RESET"],[x,"LOGIN_MFA_REQUIRED"],[y,"LOGIN_USER_NOT_FOUND"],[v,"LOGIN_HARD_BANNED_USER"],[429,"RESPONSE_CODE_TOO_MANY_REQUESTS"],[C,"SAR_DOWNLOAD_LIMIT"],[I,"SAR_EMAIL_UNVERIFIED"],[T,"SAR_EMAIL_MISSING"]])},JC6p:function(e,t,n){var i=n("cq/+"),o=n("7GkX");e.exports=function(e,t){return e&&i(e,t,o)}},JELi:function(e,t,n){var i=n("KwMD"),o=n("ut/Y"),r=n("Sxd8"),s=Math.max,a=Math.min;e.exports=function(e,t,n){var c=null==e?0:e.length;if(!c)return-1;var d=c-1;return void 0!==n&&(d=r(n),d=n<0?s(c+d,0):a(d,c-1)),i(e,o(t,3),d,!0)}},KwMD:function(e,t){e.exports=function(e,t,n,i){for(var o=e.length,r=n+(i?1:-1);i?r--:++r<o;)if(t(e[r],r,e))return r;return-1}},O7RO:function(e,t,n){var i=n("CMye"),o=n("7GkX");e.exports=function(e){for(var t=o(e),n=t.length;n--;){var r=t[n],s=e[r];t[n]=[r,s,i(s)]}return t}},P6kd:function(e,t,n){n.d(t,"a",(function(){return b}));var i=n("q1tI"),o=n("oRao"),r=n("eOdZ"),s=n("Sbkd"),a=n("vvax"),c=n("yweb"),d=n("n6mq"),l=n("nKUr");function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class h extends i.Component{constructor(...e){super(...e),u(this,"state",{recommendations:[],selectedIndex:0,resourceLoaded:!1}),u(this,"onDismiss",()=>{}),u(this,"mounted",!1),u(this,"addHashtag",e=>{this.props.addHashtag(e),this.setState({recommendations:[]})}),u(this,"handleKeyDown",e=>{38===e.keyCode?this.handlePrevHashtag(e):40===e.keyCode?this.handleNextHashtag(e):27===e.keyCode?this.handleClose(e):13===e.keyCode&&this.handleSubmit(e)}),u(this,"handlePrevHashtag",e=>{e.preventDefault(),this.state.selectedIndex>0&&this.setState(e=>({selectedIndex:e.selectedIndex-1}))}),u(this,"handleNextHashtag",e=>{e.preventDefault(),this.state.selectedIndex<this.state.recommendations.length-1&&this.setState(e=>({selectedIndex:e.selectedIndex+1}))}),u(this,"handleClose",e=>{e.preventDefault(),this.setState({recommendations:[]})}),u(this,"handleSubmit",e=>{e.preventDefault(),this.addHashtag(this.state.recommendations[this.state.selectedIndex].query)}),u(this,"callResource",e=>{const{makeCancelablePromise:t}=this.props;t(r.d.create("HashtagTypeaheadResource",{query:e,showPinCount:!0}).callGet(),"typeahead").then(e=>{if(!this.mounted)return;const t=e.resource_response.data;this.setState({recommendations:t.slice(0,5),resourceLoaded:!0})}).catch(({isCanceled:e})=>{e||this.setState({resourceLoaded:!1})})})}componentDidMount(){this.mounted=!0,this.callResource(this.props.query),window.addEventListener("keydown",this.handleKeyDown)}componentDidUpdate(e){this.props.query!==e.query&&""!==this.props.query&&this.callResource(this.props.query)}componentWillUnmount(){window.removeEventListener("keydown",this.handleKeyDown),this.mounted=!1}render(){const{recommendations:e,resourceLoaded:t,selectedIndex:n}=this.state,{anchor:i,idealDirection:r}=this.props,s=e.filter(e=>e.query),c=r||"down",u="flyout_"+s.length;return t&&s.length>0?Object(l.jsx)("div",{className:"HashtagFlyout",children:Object(l.jsx)(d.L,{anchor:i,idealDirection:c,onDismiss:this.onDismiss,size:"sm",children:Object(l.jsx)("div",{className:"HashtagRecommendations",children:s.length>0?s.map((e,t)=>Object(l.jsx)("div",{className:"HashtagItem",children:Object(l.jsx)(d.bb,{fullWidth:!1,onTap:()=>this.addHashtag(e.query),children:Object(l.jsxs)(d.f,{display:"flex",justifyContent:"between",alignItems:"center",color:t===n?"lightGray":"transparent",padding:1,children:[Object(l.jsx)(d.f,{flex:"grow",children:Object(l.jsx)(d.cb,{inline:!0,size:"md",weight:"bold",children:e.query})}),Object(l.jsx)(d.f,{flex:"none",children:Object(l.jsx)(d.cb,{inline:!0,size:"sm",children:Object(a.b)(this.props.i18n.ngettext("{{ count }} pin","{{ count }} pins",Number(e.pin_count),"label for n pins in hashtag flyout","label for n pins in hashtag flyout"),{count:Object(l.jsx)(o.a,{value:Number(e.pin_count)},"pinCount")})})})]})})},e.query)):null})},u)}):null}}function b(e){const t=Object(c.c)(),n=Object(s.a)();return Object(l.jsx)(h,{...e,makeCancelablePromise:n,i18n:t})}},SKAX:function(e,t,n){var i=n("JC6p"),o=n("lQqw")(i);e.exports=o},Sbkd:function(e,t,n){n.d(t,"a",(function(){return r}));var i=n("q1tI"),o=n("mvLR");function r(){const e=Object(i.useRef)([]),t=Object(i.useRef)({});return Object(i.useEffect)(()=>()=>{[...Object.keys(t.current).map(e=>t.current[e]),...e.current].forEach(e=>e())},[]),function(n,i){if(i){const e=t.current[i];e&&(e(),delete t.current[i])}const{cancel:r,promise:s}=Object(o.a)(n);return i?t.current[i]=r:e.current.push(r),s}}},WnNx:function(e,t,n){function i(e){return{type:"SHOW_REPIN_ANIMATION",payload:{pinId:e}}}function o(){return{type:"HIDE_REPIN_ANIMATION"}}function r(){return{type:"SHOW_ACCOUNT_MENU_FLYOUT"}}function s(){return{type:"HIDE_ACCOUNT_MENU_FLYOUT"}}n.d(t,"d",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return s}))},XKAG:function(e,t,n){var i=n("ut/Y"),o=n("MMmD"),r=n("7GkX");e.exports=function(e){return function(t,n,s){var a=Object(t);if(!o(t)){var c=i(n,3);t=r(t),n=function(e){return c(a[e],e,a)}}var d=e(t,n,s);return d>-1?a[c?t[d]:d]:void 0}}},Yo6N:function(e,t,n){n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return f}));var i=n("q1tI"),o=n("zwad"),r=n("n6mq"),s=n("nKUr");function a({action:e,alignCenter:t}){const{title:n,description:i,button:a}=e,c=n&&n.text,d=i&&i.text,l=a&&a.text||"",u=a&&a.link||"",h=a&&a.link?a.link.replace(/^(?:https?:\/\/)?(?:www\.)?/i,"").replace("/",""):"",b=a&&l&&u.startsWith("http"),p=o.a.isOffsiteUrl(u),m=b&&p?"nofollow":"none";return b?Object(s.jsxs)(r.f,{children:[Object(s.jsx)(r.f,{marginBottom:1,children:Object(s.jsx)(r.cb,{align:t?"center":"start",weight:"bold",children:""!==l?l:"Visit"})}),Object(s.jsx)(r.f,{marginBottom:1,children:Object(s.jsx)(r.C,{rel:m,href:u,children:Object(s.jsx)(r.cb,{align:t?"center":"start",lineClamp:1,weight:"normal",underline:!0,children:h})})})]}):Object(s.jsxs)(r.f,{children:[!!c&&Object(s.jsx)(r.f,{marginBottom:1,children:Object(s.jsx)(r.cb,{align:t?"center":"start",weight:"bold",children:c})}),!!d&&Object(s.jsx)(r.f,{marginBottom:1,children:Object(s.jsx)(r.cb,{align:t?"center":"start",children:d})})]})}const c={backgroundColor:"#E1F8F7",boxShadow:"0 4px 16px rgba(0, 0, 0, 0.04)"},d={boxShadow:"0 4px 16px rgba(0, 0, 0, 0.04)"};function l({inModal:e,notice:t}){const{title:n,description:i,actions:o=[]}=t,l=i&&i.text||"",u=i&&i.text_tags||[],h=1===o.length,b=m(l,u);return Object(s.jsxs)(r.f,{rounding:2,padding:6,dangerouslySetInlineStyle:{__style:e?d:c},children:[!!n&&!e&&Object(s.jsx)(r.f,{marginBottom:2,display:"flex",children:Object(s.jsx)(r.v,{size:"md",children:n})}),!!l&&Object(s.jsx)(r.f,{marginBottom:4,children:Object(s.jsx)("span",{style:{whiteSpace:"pre-wrap"},children:Object(s.jsx)(r.cb,{overflow:"normal",align:e?"center":"start",children:b})})}),!!o.length&&Object(s.jsx)(r.f,{display:"flex",wrap:!0,marginStart:-2,marginEnd:-2,direction:e?"column":"row",children:o.map(t=>Object(s.jsx)(r.f,{column:e||h?12:6,paddingY:1,paddingX:2,children:Object(s.jsx)(a,{action:t,alignCenter:e||h})},JSON.stringify(t)))})]})}var u=n("EC51");function h({notice:e}){const{actions:t=[],description:n,footer:i}=e,o=m(n&&n.text||"",n&&n.text_tags||[]),a={color:"#004b91",display:"block",fontSize:"28px",WebkitFontSmoothing:"antialiased"};return Object(s.jsxs)(r.f,{width:"100%",display:"flex",direction:"column",alignItems:"center",marginBottom:3,children:[Object(s.jsx)(r.f,{dangerouslySetInlineStyle:{__style:{backgroundColor:"#86d1ce"}},display:"flex",justifyContent:"center",width:656,rounding:8,children:Object(s.jsxs)(r.f,{height:"100%",width:"100%",padding:10,children:[Object(s.jsx)("span",{style:a,children:o}),Object(s.jsx)(r.f,{marginTop:6,children:t.map(e=>{var t;const n=null===(t=e.button)||void 0===t?void 0:t.link;var i,o,c;return n&&n.startsWith("tel")?Object(s.jsxs)(r.f,{children:[Object(s.jsx)("span",{style:{fontWeight:"600",...a},children:null===(i=e.title)||void 0===i?void 0:i.text}),Object(s.jsx)("span",{style:a,children:null===(o=e.description)||void 0===o?void 0:o.text})]}):Object(s.jsx)(u.a,{href:n||"",children:Object(s.jsx)(r.f,{display:"inlineBlock",children:Object(s.jsx)(r.f,{alignItems:"center",color:"navy",display:"flex",justifyContent:"center",height:44,rounding:"pill",paddingX:12,children:Object(s.jsx)(r.cb,{color:"white",weight:"bold",children:(null===(c=e.button)||void 0===c?void 0:c.text)||""})})})})})})]})}),!!i&&Object(s.jsx)(r.f,{paddingY:2,width:540,children:Object(s.jsx)(u.a,{inline:!0,target:"blank",href:i.link,children:Object(s.jsx)(r.cb,{align:"center",color:"gray",size:"sm",children:Object(s.jsx)("div",{dangerouslySetInnerHTML:{__html:i.text}})})},i.link)})]})}var b=n("hZxF"),p=n("U4JR");function m(e,t){const n=[];let i=0;for(let o=0;o<t.length;o+=1){const a=t[o];if(5===a.tag_type&&a.link){const t=e.substring(a.offset,a.offset+a.length),o=Object(s.jsx)(r.cb,{inline:!0,weight:"bold",children:Object(s.jsx)(u.a,{inline:!0,target:"blank",href:a.link,children:t},t)});n.push(Object(s.jsx)("span",{children:e.substring(i,a.offset)})),n.push(o),i=a.offset+a.length}}return i>0&&n.push(Object(s.jsx)("span",{children:e.substring(i)})),0===n.length?[Object(s.jsx)("span",{children:e})]:n}function f({inModal:e,notices:t,viewType:n,query:o,sensitivity:r}){return Object(b.a)(()=>{n&&Object(p.b)(120,{component:13367,view:n,entered_query:o,advisory_details:null==r?void 0:r.advisory_details,advisory_level:null==r?void 0:r.advisory,severity_level:null==r?void 0:r.severity})}),Object(s.jsx)(i.Fragment,{children:t.map(t=>2===t.style?Object(s.jsx)(h,{notice:t}):Object(s.jsx)(l,{notice:t,inModal:e}))})}},ZCpW:function(e,t,n){var i=n("lm/5"),o=n("O7RO"),r=n("IOzZ");e.exports=function(e){var t=o(e);return 1==t.length&&t[0][2]?r(t[0][0],t[0][1]):function(n){return n===e||i(n,e,t)}}},ZE2w:function(e,t,n){n.d(t,"d",(function(){return s})),n.d(t,"e",(function(){return a})),n.d(t,"a",(function(){return c})),n.d(t,"c",(function(){return d})),n.d(t,"f",(function(){return l})),n.d(t,"b",(function(){return u}));var i=n("4dcN"),o=n("eOdZ");const r="collaborator_approve_invite";function s(e,t){return o.d.create("BoardEmailInviteResource",{board_id:e,emails:t}).callCreate()}function a(e,t){return o.d.create("BoardInviteResource",{board_id:e,invited_user_ids:t}).callCreate()}function c(e,t){return n=>o.d.create("BoardInviteResource",{board_id:e,invited_user_id:t}).callUpdate().then(()=>{i.a.trackEvent(r,"success")}).catch(()=>i.a.trackEvent(r,"error"))}function d(e,t,n){return t=>{const{invited_user:i,status:r,board:{id:s}}=e;return o.d.create("accepted"===r?"BoardCollaboratorResource":"BoardInviteResource",{ban:n,board_id:s,field_set_key:"boardEdit",invited_user_id:i.id}).callDelete({showError:!1})}}function l(e,t){return async n=>{await o.d.create("ApiResource",{url:`/v3/boards/${e}/collaborators/requests/ownership/`,data:{collaborator:t}}).callCreate(),n(function(e,t){return{type:"BOARD_OWNERSHIP_TRANSFER_REQUEST",payload:{boardId:e,collaboratorId:t}}}(e,t))}}function u(e,t){return async n=>{await o.d.create("ApiResource",{url:`/v3/boards/${e}/collaborators/requests/ownership/`,data:{collaborator:t}}).callDelete(),n(function(e){return{type:"BOARD_OWNERSHIP_TRANSFER_REQUEST_CANCEL",payload:{boardId:e}}}(e))}}},ZdPf:function(e,t,n){n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return r})),n.d(t,"d",(function(){return s}));const i={CONDITIONAL:0,EMOTIONAL_DISDRESS_OR_SUICIDE:4},o={ABUSIVE:0,SENSITIVE:1,BRAND_UNSAFE:2};function r(e){if(null==e)return!1;let t=!!e.notices&&e.notices.length>0;var n;e.notices&&e.notices.length>0&&(null===(null===(n=e.notices[0])||void 0===n?void 0:n.title)&&(t=!1));return!!e.notice||t}function s(e){return!!e&&e.severity===o.ABUSIVE}},alwl:function(e,t,n){var i=n("eUgh"),o=n("ZWtO"),r=n("ut/Y"),s=n("l9OW"),a=n("1LK5"),c=n("sEf8"),d=n("IWTy"),l=n("zZ0H"),u=n("Z0cm");e.exports=function(e,t,n){t=t.length?i(t,(function(e){return u(e)?function(t){return o(t,1===e.length?e[0]:e)}:e})):[l];var h=-1;t=i(t,c(r));var b=s(e,(function(e,n,o){return{criteria:i(t,(function(t){return t(e)})),index:++h,value:e}}));return a(b,(function(e,t){return d(e,t,n)}))}},"b/K5":function(e,t,n){n.d(t,"a",(function(){return j}));var i=n("q1tI"),o=n("n6mq"),r=n("nKUr");function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const a=["#0074e8","#0FA573","#B469EB","#F13535","#E2780D"],c=(e,t)=>Math.random()*((e||1)-(t||0))+(t||0),d=e=>e*(Math.PI/180);class l extends i.PureComponent{constructor(...e){super(...e),s(this,"animationTimer",null),s(this,"canvasRemovalTimer",null),s(this,"containerRef",Object(i.createRef)()),s(this,"buildCanvas",()=>{if(!this.containerRef.current)return null;const{height:e,width:t}=this.containerRef.current.getBoundingClientRect(),n=2.5*e,i=document.createElement("canvas");return i.style.position="absolute",i.style.left=0-(n-t)/2+"px",i.style.top=0-(n-e)/2+"px",i.style.pointerEvents="none",i.style.width=n+"px",i.style.height=n+"px",i.style.overflow="visible",i.width=n,i.height=n,i}),s(this,"explode",()=>{const e=this.buildCanvas(),t=this.containerRef.current;if(!e||!t)return;const n=e.getContext("2d");t.prepend(e);const i=Array.from(Array(120)).map(()=>({x:e.width/2,y:e.height/2,radius:Math.round(c(10,30)),color:a[Math.floor(Math.random()*a.length)],degree:Number(c(0,360).toFixed(1)),speed:Math.round(c(0,25)),friction:.9,opacity:Number(c(0,.5).toFixed(1)),yVel:0,gravity:.04})),o=(e,t,n,i)=>{window.requestAnimationFrame(()=>o(e,t,n,i)),t.clearRect(0,0,n,i),e.forEach((e,n)=>{e.x+=e.speed*Math.cos(d(e.degree)),e.y+=e.speed*Math.sin(d(e.degree)),e.opacity-=.01,e.speed*=e.friction,e.radius*=e.friction,e.yVel+=e.gravity,e.y+=e.yVel,e.opacity<0||e.radius<0||(t.beginPath(),t.globalAlpha=e.opacity,t.fillStyle=e.color,t.arc(e.x,e.y,e.radius,0,2*Math.PI,!1),t.fill())})};o(i,n,e.width,e.height),this.canvasRemovalTimer=setTimeout(()=>{t.removeChild(e)},(this.props.delay||0)+800)})}componentDidUpdate(e){const{delay:t,startAnimation:n}=this.props,{startAnimation:i}=e;n&&i!==n&&(this.animationTimer=setTimeout(this.explode,t))}componentWillUnmount(){this.animationTimer&&clearTimeout(this.animationTimer),this.canvasRemovalTimer&&clearTimeout(this.canvasRemovalTimer)}render(){return Object(r.jsx)(o.f,{ref:this.containerRef,position:"relative",children:this.props.children})}}s(l,"defaultProps",{delay:0});var u=l,h=n("vvax"),b=n("yweb");function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const m=e=>({opacity:e?1:0,WebkitTransition:"opacity .5s ease-in-out .75s",transition:"opacity .5s ease-in-out .75s",overflow:"visible"}),f=e=>({opacity:e?1:0,WebkitTransform:e?"translateY(0)":"translateY(20%)",transform:e?"translateY(0)":"translateY(20%)",WebkitTransition:"all .5s ease-in-out .75s",transition:"all .5s ease-in-out .75s",textAlign:"center",marginTop:"24px"});class g extends i.PureComponent{constructor(...e){super(...e),p(this,"state",{isInitialized:!1}),p(this,"containerRef",Object(i.createRef)()),p(this,"pinDestinationRef",Object(i.createRef)())}componentDidMount(){this.requestAnimationFrameId=window.requestAnimationFrame(()=>{this.setState({isInitialized:!0})})}componentWillUnmount(){this.dismissTimeout&&clearTimeout(this.dismissTimeout)}componentDidUpdate(e,t){const{isInitialized:n}=this.state,{onDismiss:i}=this.props;n&&i&&!this.dismissTimeout&&(this.dismissTimeout=setTimeout(i,2600))}render(){const{firstRepin:e,pin:t,pinImageRef:n,selectedBoardName:s}=this.props,{description:a="",images:c}=t,{height:d=0,width:l=0,url:b=""}=(null==c?void 0:c["236x"])||{},{isInitialized:p}=this.state,{mask:g,imageContainer:j}=((e,t,n,i)=>{var o,r,s;let a,c,d={};const l=null===(o=n.current)||void 0===o?void 0:o.getBoundingClientRect(),u=null===(r=t.current)||void 0===r?void 0:r.getBoundingClientRect(),h=null===(s=i.current)||void 0===s?void 0:s.getBoundingClientRect();if(u&&l&&h){d={left:l.left-u.left,top:l.top-u.top};const e={x:h.left-l.left,y:h.top-l.top},t={x:(h.width-l.width)/2,y:(h.height-l.height)/2};a=`translate(${e.x}px, ${e.y}px)`,c=`translate(${t.x}px, ${t.y}px)`}return{mask:{position:"absolute",left:d.left,top:d.top,width:e?null==h?void 0:h.width:null==l?void 0:l.width,height:e?null==h?void 0:h.height:null==l?void 0:l.height,WebkitTransformOrigin:"left top",transformOrigin:"left top",WebkitTransform:e?a:"none",transform:e?a:"none",WebkitTransition:"all .5s ease-in-out .25s",transition:"all .5s ease-in-out .25s",borderRadius:e?"8px 0px 0px 8px":"8px",zIndex:2},imageContainer:{width:null==l?void 0:l.width,height:null==l?void 0:l.height,WebkitTransformOrigin:"left top",transformOrigin:"left top",WebkitTransform:e?c:"none",transform:e?c:"none",WebkitTransition:"all .5s ease-in-out .25s",transition:"all .5s ease-in-out .25s"}}})(p,this.containerRef,n,this.pinDestinationRef);return Object(r.jsx)(i.Fragment,{children:Object(r.jsxs)(o.f,{position:"absolute",top:!0,bottom:!0,right:!0,left:!0,ref:this.containerRef,children:[Object(r.jsx)(o.f,{maxHeight:335,overflow:"hidden",dangerouslySetInlineStyle:{__style:g},children:Object(r.jsx)(o.f,{dangerouslySetInlineStyle:{__style:j},children:Object(r.jsx)(o.y,{alt:null!=a?a:"",src:b||"",naturalHeight:d||1,naturalWidth:l||1})})}),Object(r.jsx)(o.f,{color:"white",position:"absolute",top:!0,bottom:!0,right:!0,left:!0,dangerouslySetInlineStyle:{__style:(O=p,{pointerEvents:"none",opacity:O?1:0,WebkitTransition:"opacity .3s ease-in-out",transition:"opacity .3s ease-in-out",zIndex:1})},children:Object(r.jsxs)(o.f,{display:"flex",justifyContent:"center",alignItems:"center",direction:"column",height:"100%",dangerouslySetInlineStyle:{__style:m(p)},children:[Object(r.jsx)(u,{delay:1250,startAnimation:p,children:Object(r.jsx)(o.D,{rounding:2,width:270,height:180,children:Object(r.jsxs)(o.u,{alignItems:"stretch",justifyContent:"start",height:"100%",width:"100%",children:[Object(r.jsx)(o.f,{ref:this.pinDestinationRef,color:"transparent",marginEnd:1,flex:"grow",height:"100%"}),Object(r.jsxs)(o.u,{alignItems:"stretch",justifyContent:"start",direction:"column",width:80,children:[Object(r.jsx)(o.f,{color:"lightGray",flex:"grow",marginBottom:1}),Object(r.jsx)(o.f,{color:"lightGray",flex:"grow"})]})]})})}),Object(r.jsx)(o.f,{paddingX:2,dangerouslySetInlineStyle:{__style:f(p)},children:Object(r.jsx)(o.v,{align:"center",children:e?Object(h.b)(this.props.i18n._("You saved your first Pin to {{ selectedBoardName }}!","First board create confirmation message","First board create confirmation message"),{selectedBoardName:null!=s?s:""}):Object(h.b)(this.props.i18n._("You saved this Pin to {{ selectedBoardName }}!","Board create confirmation message","Board create confirmation message"),{selectedBoardName:null!=s?s:""})})})]})})]})});var O}}function j(e){const t=Object(b.c)();return Object(r.jsx)(g,{...e,i18n:t})}p(g,"defaultProps",{firstRepin:!1})},c50B:function(e,t,n){n.d(t,"p",(function(){return r})),n.d(t,"d",(function(){return s})),n.d(t,"e",(function(){return a})),n.d(t,"m",(function(){return c})),n.d(t,"a",(function(){return d})),n.d(t,"o",(function(){return l})),n.d(t,"i",(function(){return u})),n.d(t,"l",(function(){return h})),n.d(t,"r",(function(){return b})),n.d(t,"n",(function(){return p})),n.d(t,"j",(function(){return m})),n.d(t,"f",(function(){return f})),n.d(t,"g",(function(){return g})),n.d(t,"h",(function(){return j})),n.d(t,"b",(function(){return O})),n.d(t,"c",(function(){return v})),n.d(t,"t",(function(){return x})),n.d(t,"q",(function(){return S})),n.d(t,"k",(function(){return y})),n.d(t,"s",(function(){return _})),n.d(t,"u",(function(){return w}));var i=n("jZDM");const o=e=>{const t={"０":"0","１":"1","２":"2","３":"3","４":"4","５":"5","６":"6","７":"7","８":"8","９":"9","　":" "},n=String(e).split("");return n.forEach((e,i)=>{const o=t[e];o&&(n[i]=o)}),n.join("")};function r(e){return function(t,n){const i=[];t&&/\S/.test(t)||i.push(e.message);const o={errors:i,warnings:[]};return n&&n(o),o}}const s=new RegExp(["(^[-!#$%&'*+/=?^_`{}|~0-9A-Z]+(\\.[-!#$%&'*+/=?^_`{}|~0-9A-Z]+)*",'|^"([\\001-\\010\\013\\014\\016-\\037!#-\\[\\]-\\177]|\\\\[\\001-\\011\\013\\014\\016-\\177])*"',")@((?:[A-Z0-9](?:[A-Z0-9-]{0,61}[A-Z0-9])?\\.)+[A-Z]{2,20}$)","|\\[(25[0-5]|2[0-4]\\d|[0-1]?\\d?\\d)(\\.(25[0-5]|2[0-4]\\d|[0-1]?\\d?\\d)){3}\\]$"].join(""),"i");function a(e){return function(t,n){const i=[];(t=t&&t.trim())&&!t.match(s)&&i.push(e.message);const o={errors:i,warnings:[]};return n&&n(o),o}}function c(e){return function(t,n){const i=[];(t=t&&t.trim())&&!t.match(/^[^0-9].*$/)&&i.push(e.message);const o={errors:i,warnings:[]};return n&&n(o),o}}function d(e){return function(t,n){const i=o(t.trim()),r=[];if(i)if(i.length<2&&r.push(e.ageTooShortString),/^\d+$/.test(i)){const t=parseInt(i,10);t<=0||t>=300?r.push(e.invalidAgeString):e.checkUnderAgeWithString&&t<12&&r.push(e.checkUnderAgeWithString)}else r.push(e.invalidAgeString);const s={errors:r,warnings:[]};return n&&n(s),s}}function l(e){return function(t,n){const i=(t=t&&t.trim()).replace(/[\(\)\+\-\. ]/g,""),o=[],r=!1!==e.checkLength&&i.length<7;!t||t.match(/^(\(?\+?[0-9]*\)?)?[0-9_\- \.\(\)]*$/g)&&!r||o.push(e.message);const s={errors:o,warnings:[]};return n&&n(s),s}}function u(e){return function(t,n){const i=/^\d+$/,r=[];"number"==typeof t||"string"==typeof t&&(t=t&&t.trim(),(t=o(t))&&!t.match(i)&&r.push(e.message));const s={errors:r,warnings:[]};return n&&n(s),s}}function h(e){return function(t,n){const i=/^[\d\ -]+$/,r=[];"number"==typeof t||"string"==typeof t&&(t=t&&t.trim(),(t=o(t))&&!t.match(i)&&r.push(e.message));const s={errors:r,warnings:[]};return n&&n(s),s}}function b(e){return function(t,n){const i=[];t&&!t.match(/^(https?:\/\/){0,1}[a-z0-9_\-]+\..+/gi)&&i.push(e.message);const o={errors:i,warnings:[]};return n&&n(o),o}}function p(e){return function(t,n){const o=[];if(t)try{const n=Object(i.a)(t);n&&n.protocol&&("http"!==n.protocol||"localhost"===n.hostname)||o.push(e.message)}catch(s){o.push(e.message)}const r={errors:o,warnings:[]};return n&&n(r),r}}function m(e){return function(t,n){const i=[];(e.should_trim||!1)&&(t=t&&t.trim());const o=t.length;e.min&&o<e.min?i.push(e.minErrorString):e.max&&o>e.max&&i.push(e.maxErrorString);const r={errors:i,warnings:[]};return n&&n(r),r}}function f(e){return function(t,n){const i=[];t!==(e&&e.targetValue)&&i.push(e.message);const o={errors:i,warnings:[]};return n&&n(o),o}}function g(e){return function(t,n){t&&(t=parseFloat(t));const i=[];t<=e.value&&i.push(e.message);const o={errors:i,warnings:[]};return n&&n(o),o}}function j(e){return function(t,n){t&&(t=parseFloat(t));const i=[];t<e.value&&i.push(e.message);const o={errors:i,warnings:[]};return n&&n(o),o}}function O(e){return function(t,n){const i=[];/^[\040-\176]*$/.test(t)||i.push(e.message);const o={errors:i,warnings:[]};return n&&n(o),o}}function v(e){return function(t,n){const i=e.hasFractionalCents?/^\d*(\.\d\d?\d?)?$/:/^\d*(\.\d\d?)?$/,o=[];"number"==typeof t&&(t=t.toString()),t&&!t.match(i)&&(t=t&&t.trim(),o.push(e.message));const r={errors:o,warnings:[]};return n&&n(r),r}}function x(e){return function(t,n){t=t&&t.trim();const i=[],o=new Date(t);t&&!o.getTime()&&i.push(e.message);const r={errors:i,warnings:[]};return n&&n(r),r}}function S(e){return function(t,n){const i=[];(t=t&&t.trim())&&!t.match(/^([01]?[0-9]|2[0-3]):[0-5][0-9]$/)&&i.push(e.message);const o={errors:i,warnings:[]};return n&&n(o),o}}function y(e){return function(t,n){const i=[];e.pattern.test(t)||i.push(e.message);const o={errors:i,warnings:[]};return n&&n(o),o}}function _(e,t){const n=e.map(e=>e(t).errors);return[].concat(...n)}function w(e,t){let n="";return t.some(t=>{const i=t(e);return i.errors.length>0&&(n=i.errors[0],!0)}),n}},dtqy:function(e,t,n){var i=n("q1tI"),o=n("/MKj"),r=n("5S2N"),s=n("ANjH"),a=n("U4JR"),c=n("Sp3T"),d=n("nKUr");t.a=Object(s.compose)(Object(o.connect)(({pins:e},{pinId:t,carouselSlotCurrentIndex:n})=>{const{carousel_data:i}=e&&t&&e[t]||{},{index:o}=i||{};return void 0!==n?{carouselSlotCurrentIndex:o||n||0}:{}}),(function(e){return function(t){const[n,o]=Object(i.useState)(!1),s=Object(c.a)({shouldStopEventPropagation:!1}),{pinId:l,onDelete:u,onSubmit:h,carouselSlotCurrentIndex:b}=t;return Object(d.jsxs)(i.Fragment,{children:[Object(d.jsx)(e,{...t,handlePinEditButtonClick:s(e=>{e&&e.stopPropagation();const{component:n,onToggleModal:i}=t;i&&i(!0),Object(a.b)(101,{element:3,...n?{component:n}:{}}),o(!0)})}),n&&Object(d.jsx)(r.a,{carouselSlotCurrentIndex:b,onDelete:u,onHide:()=>{o(!1),t.onToggleModal&&t.onToggleModal(!1)},onSubmit:h,pinId:l})]})}}))},"e/jn":function(e,t,n){function i(e,t){if(!t)return e;const n=new RegExp(/http(s?):/);if(!n.test(e)){const i=n.exec(t);if(i&&i.length){e=i[0]+e}}return e}n.d(t,"a",(function(){return i}))},e0nq:function(e,t,n){function i(e){return{type:"PIN_BETTER_SAVE",payload:e}}function o(e){return{type:"PIN_BETTER_UNSAVE",payload:e}}function r(e){return{type:"PIN_BETTER_SELECT_BOARD_OR_SECTION",payload:e}}function s(e){return{type:"POST_REPIN_MORE_IDEAS_UPSELL_SHOWN",payload:{boardId:e}}}n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return s}))},eUcp:function(e,t,n){n.d(t,"j",(function(){return o})),n.d(t,"f",(function(){return r})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return c})),n.d(t,"l",(function(){return d})),n.d(t,"i",(function(){return l})),n.d(t,"k",(function(){return u})),n.d(t,"h",(function(){return h})),n.d(t,"e",(function(){return b})),n.d(t,"b",(function(){return p})),n.d(t,"g",(function(){return m})),n.d(t,"m",(function(){return f}));var i=n("n6mq");const o=new i.t(0),r=new i.t(1),s=2,a=new i.t(s),c=2,d=new i.t(c),l=new i.t(3),u=new i.t(1),h=new i.t(3),b=3,p=4,m=(new i.t(p),new i.t(5)),f=new i.t(100)},fEA9:function(e,t,n){n.r(t),n.d(t,"PinBetterSave",(function(){return X}));var i=n("q1tI"),o=n("/MKj"),r=n("yweb"),s=n("n6mq"),a=n("nKUr");function c({dropdownRef:e,hideDropdown:t=!1,onBoardDropdownClick:n,onSaveClick:o,renderPinSaveTooltip:c,selectedTitle:d,unselectedText:l,view:u}){const h=Object(r.c)(),b=Object(i.useRef)(),p=d||l,m="closeup"===u,f=m?"darkGray":"white";return Object(a.jsxs)(s.f,{alignItems:"center",display:"flex",width:"100%",ref:e,children:[!t&&Object(a.jsx)(s.f,{flex:"grow",paddingX:m?4:1,width:"100%",children:Object(a.jsx)(s.bb,{onTap:({event:e})=>n(e),rounding:6,children:Object(a.jsxs)(s.u,{alignItems:"center",flex:"grow",height:48,justifyContent:m?"end":"start",children:[Object(a.jsx)(s.f,{width:"auto",overflow:"auto","data-test-id":"PinBetterSaveDropdown",children:Object(a.jsx)(s.cb,{color:f,lineClamp:1,size:"lg",weight:"bold",children:p})}),Object(a.jsx)(s.f,{"data-test-id":"boardSelectionDropdown",flex:"none",marginStart:p.length<13?2:1,marginEnd:1,children:Object(a.jsx)(s.w,{accessibilityLabel:h._("Select a board you want to save to","PinBetterSave.BoardSelection.DropdownIcon","BetterSave accessibility label to change the board"),color:f,icon:"arrow-down",size:12})})]})})}),Object(a.jsx)(s.f,{"data-test-id":"PinBetterSaveButton",flex:"none",marginStart:"auto",alignSelf:m?"center":"start",children:Object(a.jsx)(s.g,{color:"red",onClick:({event:e})=>{t?n(e):o(e)},ref:b,size:"lg",text:h._("Save","PinBetterSave.BoardSelection.SaveButton","BetterSave Save label")})}),!!c&&!!b.current&&c(b.current)]})}var d=n("i1AX"),l=n("clxp"),u=n("1inl"),h=n("ajUs"),b=n("uVIr"),p=n("EC51"),m=n("juJw"),f=n("eOdZ"),g=n("lm6u");function j(e){const{action:t,additionalCreateFields:n,boardWithSection:o,children:r,onClose:s,pin:c,setCompletionPromise:d,showModal:l}=e,u=((e,t)=>{const[n,o]=Object(i.useState)([]);return Object(i.useEffect)(()=>{let n=!1;return e&&f.d.create("SectionRecommendationsResource",{pinIds:[t]}).callGet().then(e=>{var t;if(n)return;const i=null==e||null===(t=e.resource_response)||void 0===t?void 0:t.data;o(i.length>0&&i[0]||[])}),()=>{n=!0}},[e,t]),n})(l,c.id);return Object(a.jsx)(g.a,{additionalCreateFields:n,boardWithSection:o,action:t,hideSuccessAnimation:!!u.length,onClose:s,setCompletionPromise:d,showCreate:!0,shouldShowToast:!u.length,pin:c,children:e=>r({...e,sectionSuggestions:u})})}var O=n("qnp8"),v=n("uyxo"),x=n("M1Uz"),S=n("sUAf"),y=n("xkL+"),_=n("e3KR"),w=n("Wrea"),C=n("KFEb"),I=n("0zyx"),T=n("x12c"),R=n("J8m7"),P=n("EuRG"),E=n("H/Lk"),B=n("WnNx"),A=n("U4JR"),k=n("NjDU"),N=n("B6Tf"),D=n("vvax"),M=n("e0nq");class L extends i.PureComponent{constructor(...e){var t,n,i;super(...e),i=()=>{const{boardId:e}=this.props;Object(A.b)(101,{component:20,element:10805,objectId:e})},(n="handleClick")in(t=this)?Object.defineProperty(t,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[n]=i}componentDidMount(){const{toastShown:e}=this.props;e()}render(){const{boardName:e,boardUrl:t,onHide:n}=this.props;return Object(a.jsx)(x.a,{duration:5e3,onHide:n,text:Object(a.jsx)(s.cb,{weight:"bold",children:Object(D.b)(this.props.i18n._("Find more ideas for {{ boardName }}","postRepinUpsellToast.findMoreIdeas.toast","Find more ideas for you board"),{boardName:e}).join("")}),href:t+"more_ideas/?ideas_referrer=16",onClick:this.handleClick})}}var U=Object(o.connect)(null,(e,t)=>({toastShown:()=>e(Object(M.c)(t.boardId))}))((function(e){const t=Object(r.c)();return Object(a.jsx)(L,{...e,i18n:t})})),F=n("Sp3T"),H=n("w70y"),z=n("ZdPf"),W=n("seP0"),q=n("nGHF"),G=n("0nTG"),V=n("EC67");function K(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Y({savedInfo:e,variant:t}){const n=Object(r.c)(),i="closeup"===t,o="boardless"===e.type?n._("Profile","PinBetterSave.PinBetterSaveSavedStatus.savedTitle","Text indicating saved to your profile"):e.title;return Object(a.jsx)(p.a,{onClick:({event:e})=>{e.stopPropagation()},href:e.url||"",children:Object(a.jsx)(s.f,{dangerouslySetInlineStyle:{__style:{color:"#333"}},marginStart:i?1:0,children:Object(a.jsx)(s.cb,{color:"darkGray",size:"lg",weight:"bold",align:i?"end":void 0,children:o.length<=20?o:Object(m.a)(o,20)})})})}class X extends i.Component{constructor(...e){var t;super(...e),t=this,K(this,"state",{boardWithSection:null,createdBoard:null,suggestedBoardTitle:"",showBoardFlyout:!1,showEmailVerificationModal:!1,showRepinModal:!1,sensitiveContentNotice:null}),K(this,"setBoardSaveCompletionPromise",e=>{const{createdBoard:t}=this.state;this._repinCompletionPromise=e,this._repinCompletionPromise.promise.then(e=>{if(!e.board)return;const{board:{id:n,name:i,url:o}}=e,r={boardId:n,title:i,url:o};this.updateSelectedBoardOrSection(r),this.updateSavedState({...r,localPinId:e.id}),t&&Object(z.d)(t.sensitivity)&&Object(z.c)(t.sensitivity)?this.setState({sensitiveContentNotice:t.sensitivity.notice||t.sensitivity.notices[0]}):this.handleRepinHide()})}),K(this,"updateSavedState",e=>{const{reduxLocation:t,save:n,searchQueryInvalidated:i,onSave:o,pin:{id:r}}=this.props,s=t.query&&t.query.q||Object(I.a)(t.history);n({pinId:r,...e}),s&&i(s),o&&e.localPinId&&o()}),K(this,"updateSelectedBoardOrSection",e=>{const{selectBoardOrSection:t,pin:{id:n}}=this.props;t({pinId:n,...e})}),K(this,"updateSelectedItem",()=>{const{initialSelection:e,selectedItem:t}=this.props;!t&&e&&this.updateSelectedBoardOrSection(e)}),K(this,"dropdownRef",Object(i.createRef)()),K(this,"handleItemChosen",e=>{this.updateSelectedBoardOrSection(e),this.hideFlyout(!0),this.save(e)}),K(this,"handleBoardCreate",this.props.requireAuth(({title:e=""}={})=>{this.hideFlyout(!0),this.setState(t=>({...t,suggestedBoardTitle:e,showRepinModal:!0}));const{onToggleFlyout:t}=this.props;t&&t(!0,!0)})),K(this,"handleBoardCreated",e=>{this.setState({createdBoard:e})}),K(this,"handleRepinHide",()=>{this.setState(e=>({...e,suggestedBoardTitle:"",showRepinModal:!1}));const{onToggleFlyout:e}=this.props;e&&e(!1,!1)}),K(this,"handleBoardDropdownClick",e=>{const{pin:{id:t},viewParameter:n,viewType:i,location:{pathname:o},boardPickerStopwatch:r}=this.props;e&&e.preventDefault&&e.preventDefault(),e&&e.stopPropagation&&e.stopPropagation(),this.state.showBoardFlyout?this.hideFlyout(!0):(Object(A.b)(101,{view:i,viewParameter:n,component:13282,element:10960,objectId:t}),r&&(r.start(),Object(W.b)(r,o)),this.showFlyout())}),K(this,"handleSaveClick",this.props.requireAuth((async function(e){const{selectedItem:n,viewType:i,viewParameter:o}=t.props;n?(e&&e.preventDefault&&e.preventDefault(),e&&e.stopPropagation&&e.stopPropagation(),Object(A.b)(101,{...i?{view:i}:{},...o?{viewParameter:o}:{},component:13282,element:36,objectId:n.boardId,grid_index:4}),await t.save(n)):t.handleBoardDropdownClick(e)}))),K(this,"setBoardWithSection",e=>{this.setState({boardWithSection:e})}),K(this,"handleEditSubmit",({boardId:e,sectionId:t,url:n,title:i})=>{const{pin:{id:o},savedInfo:{localPinId:r}={}}=this.props;this.updateSavedState({pinId:o,localPinId:r,boardId:e,sectionId:t||"",url:n,title:i})}),K(this,"resetPinSavedState",()=>{this.updateSavedState({boardId:"",localPinId:"",sectionId:"",title:"",url:""})}),K(this,"deleteSavedState",e=>{const{unsave:t,onDelete:n,pin:{id:i},toastManagerContext:o}=this.props;t({pinId:i}),e&&f.d.create("PinResource",{id:e}).callDelete().then(()=>{o.showToast(({onHide:e})=>Object(a.jsx)(x.a,{onHide:e,text:this.props.i18n._("Pin deleted!","PinBetterSave.SavedPin.Delete","User deleted their pin")}))}),n&&n()}),K(this,"save",(async function(e){const{addNewPinToPinsFeed:n,isLimitedLogin:i,mostRecentBoard:o,pin:{id:r},postRepinMoreIdeasUpsell:s,postRepinUpsellDisabled:c,save:d,setMostRecentBoard:l,toastManagerContext:h}=t.props;t.updateSavedState(e);const b=!!e.sectionId,p="boardless"===e.type;try{const{resource_response:{data:i}}=await t.getPinResource(e).callCreate({showError:!1}),u=e.url,{incrementBoardPinCount:m,updateUserPinCount:f,viewerUserId:g}=t.props;!c&&u&&!p&&(({boardId:e,boardUrl:t,postRepinMoreIdeasUpsell:n})=>{if(!t)return!1;const{recentSaves:i,recentUpsell:o}=n;if(o[e])return!1;const r=i.findIndex(t=>t.boardId!==e);return(-1===r?i.length:r)+1>=3})({boardId:e.boardId,boardUrl:u,postRepinMoreIdeasUpsell:s})&&h.showToast(({onHide:t})=>Object(a.jsx)(U,{boardId:e.boardId,boardName:e.title,boardUrl:u,onHide:t})),d({pinId:r,...{...e,localPinId:i.id,localPin:i}}),T.b.publish("currentUser","pinCreated",i),T.b.publish(i.board.id,"pinCreated",{pin:i}),m({boardId:e.boardId,sectionId:e.sectionId}),f(g);let j=e.sectionId?e.sectionId:e.boardId;p?(j=g,n(j,i.id,!1,p)):n(j,i.id,b,!1);const{id:v,images:x,board:S}=i,y=x["236x"];t.updateSavedState({pinId:r,...{...e,localPinId:v}}),h.showToast(({onHide:n})=>Object(a.jsx)(O.a,{boardName:e.title,boardUrl:e.url||S.url,isBoardlessPin:p,onHide:n,onUndo:()=>t.deleteSavedState(v),pinImageUrl:p&&e.url?e.url:y.url})),o&&e.boardId!==o.id&&!p&&l(e.boardId,e.title,e.url)}catch(m){m&&m.api_error_code===R.B?t.setState({showEmailVerificationModal:!0}):i||u.a.showError(m.message_detail||m.message),t.resetPinSavedState()}})),K(this,"hideFlyout",(e=!1)=>{const{onToggleFlyout:t}=this.props;this.setState({showBoardFlyout:!1}),t&&t(!1,e)}),K(this,"closeModal",()=>{this.setState({showEmailVerificationModal:!1})})}componentDidMount(){const{onMount:e}=this.props;this.updateSelectedItem(),e&&e()}componentDidUpdate(){this.updateSelectedItem()}getPinResource(e){const{carouselData:t,location:n,previousHistory:i,pin:o}=this.props,r={carousel_slot_index:t&&t.index||0,clientTrackingParams:Object(h.a)(o,n,i)||(o.tracking_params||"")+"~0",description:o.description||"",image_base64:o.image_base64,is_buyable_pin:!1,is_removable:o.promoted_is_removable,link:o.link,pin_id:o.id||"",title:o.title||"",...e.boardId&&"boardless"!==e.type?{board_id:e.boardId}:null,...e.sectionId?{section:e.sectionId}:null,...Object(G.f)(o)||{}};return f.d.create("RepinResource",r)}showFlyout(){const{onToggleFlyout:e}=this.props;this.setState({showBoardFlyout:!0}),e&&e(!0,!0)}render(){const{boardResource:e,carouselData:t,onToggleModal:n,pin:i,renderPinSaveTooltip:o,renderSavedStatus:r,savedInfo:u,selectedItem:h,unselectedText:b,variant:p,viewParameter:m,hideDropdown:f,showSaveToProfile:g}=this.props,{boardWithSection:O,showBoardFlyout:x,showEmailVerificationModal:S,showRepinModal:y,sensitiveContentNotice:w,suggestedBoardTitle:C}=this.state,I=Object(a.jsx)(_.a,{boardResource:e,setBoardWithSection:this.setBoardWithSection,showSaveToProfile:g,onItemChosen:this.handleItemChosen,onBoardCreate:this.handleBoardCreate,pin:i});return Object(a.jsxs)(l.a,{name:"PinBetterSave",children:[S&&Object(a.jsx)(d.a,{onConfirm:this.closeModal}),Object(a.jsxs)(s.f,{display:"closeup"===p?"flex":void 0,height:60,children:[null!=u&&u.title?Object(a.jsx)(v.a,{currentCarouselIndex:t&&t.index,onDeleteSavedState:()=>this.deleteSavedState(u.localPinId),onEditSubmit:this.handleEditSubmit,onToggleModal:n,pinId:u.localPinId,variant:p,viewParameter:m,shouldUseLegoStyles:!0,children:r&&u&&r({savedInfo:u,variant:p})}):Object(a.jsx)(c,{dropdownRef:this.dropdownRef,onBoardDropdownClick:this.handleBoardDropdownClick,onSaveClick:this.handleSaveClick,renderPinSaveTooltip:o,selectedTitle:h&&h.title,unselectedText:b,view:p,hideDropdown:f}),Object(a.jsx)(j,{additionalCreateFields:{is_stl_pin:Object(G.k)(i)},boardWithSection:O,action:"create",onClose:this.handleRepinHide,setCompletionPromise:this.setBoardSaveCompletionPromise,showModal:y,pin:i,children:({boardSavedTo:e,dismissModal:t,displaySuccessAnimation:n,handleAbort:i,handleNewBoardAnimationCompletion:o,handleSocialConnectSet:r,handleSaveToBoard:s,newPin:c,updateDescription:d,modalTitle:l,sectionSuggestions:u,setModalTitle:h,pin:b})=>Object(a.jsx)(N.c,{boardSavedTo:e,isInModal:!0,displaySuccessAnimation:n,dismissModal:t,handleAbort:i,handleNewBoardAnimationCompletion:o,handleSocialConnectSet:r,handleSaveToBoard:s,updateDescription:d,onBoardCreated:this.handleBoardCreated,sensitiveContentNotice:w,pin:b,pwtAuxData:{pin_create_method:"repin"},sectionSuggestions:u,suggestedBoardTitle:C,boardWithSection:O,shouldRenderContent:y,newPin:c,modalTitle:l,setModalTitle:h,showCreate:!0})}),x&&Object(a.jsx)(s.A,{children:Object(a.jsx)(s.L,{anchor:this.dropdownRef.current,idealDirection:"down",onDismiss:this.hideFlyout,positionRelativeToAnchor:!1,size:"xl",children:I})})]})]})}}K(X,"defaultProps",{variant:"pin",renderSavedStatus:({savedInfo:e,variant:t})=>Object(a.jsx)(Y,{savedInfo:e,variant:t})});t.default=Object(i.memo)((function(e){var t;const n=Object(r.c)(),{pin:{id:i}}=e,c=Object(H.a)({name:"BoardPickerBoardsResource",options:{field_set_key:"board_picker"}}),d=Object(H.a)({name:"BoardPickerBoardsShortlistResource",options:{pin_id:e.pin.id,shortlist_length:2,num_shortlist_suggestions:2,suggestions_only:!0,min_confidence:.5}}),l=Object(V.h)(),u=Object(V.i)(),h=Object(q.b)(),p=Object(W.c)(),m=Object(y.b)(),f=Object(o.useDispatch)(),g=Object(o.useSelector)(({mostRecentBoard:e})=>e),j=Object(o.useSelector)(({pins:e})=>e[i]),O=Object(o.useSelector)(({history:e})=>e.previous),v=Object(o.useSelector)(({location:e})=>e),x=Object(o.useSelector)(({ui:e})=>e.postRepinMoreIdeasUpsell);let _=e.initialSelection,I=(null===(t=_)||void 0===t?void 0:t.title)||"",T=!0;const{showEnabledSaveBehavior:R}=Object(S.a)(m.id||""),A={boardId:"",title:n._("Profile","pinBetterSave.initialSelection.boardlessPinsOption","Option to save to profile without a board."),type:"boardless",url:"/me/"},N=Object(F.a)();if(!_){const e=d&&d.data&&d.data[0];_=d&&d.isLoaded&&e&&{boardId:e.id,title:e.name,url:e.url}||d&&d.isLoaded&&!e&&R&&A||d&&d.isLoaded&&!e&&g&&{boardId:g.id,title:g.name,url:g.url}||void 0,I=d&&d.isLoaded?n._("Select","BetterSave label to pick a board from the list","BetterSave label to pick a board from the list"):"...",T=!1}return Object(a.jsx)(s.f,{overflow:"hidden",children:Object(a.jsx)(X,{...e,addNewPinToPinsFeed:(e,t,n,i)=>{let o=n?C.a.SECTION_PINS:C.a.BOARD_PINS;i&&(o=C.a.BOARDLESS_PINS),f(Object(b.a)({feedId:e,feedType:o,itemIds:[t],itemType:"pin"}))},boardResource:c,boardPickerStopwatch:p,carouselData:j&&j.carousel_data,history:l,incrementBoardPinCount:({boardId:e,sectionId:t})=>f(Object(w.d)({boardId:e,sectionId:t,increment:1})),initialSelection:_,isLimitedLogin:m.isLimitedLogin,location:u,mostRecentBoard:g,postRepinMoreIdeasUpsell:x,postRepinUpsellDisabled:T,previousHistory:O,reduxLocation:v,save:e=>f(Object(M.a)(e)),savedInfo:j&&j.savedInfo,searchQueryInvalidated:e=>f(Object(P.b)(e)),selectBoardOrSection:e=>f(Object(M.b)(e)),selectedItem:j&&j.selectedItem,setMostRecentBoard:(e,t,n)=>f(Object(E.a)(e,t,n)),showSaveToProfile:R,showRepinAnimation:e=>f(Object(B.d)(e)),toastManagerContext:h,unsave:e=>f(Object(M.d)(e)),unselectedText:I,updateUserPinCount:e=>f(Object(k.c)({userId:e,increment:1})),viewerUserId:m.isAuth?m.id:"",requireAuth:N,i18n:n})})}))},"g/XF":function(e,t,n){n.d(t,"a",(function(){return a}));var i=n("JW66"),o=n("jZDM"),r=n("n6mq"),s=n("nKUr");function a({url:e,description:t,color:n}){return n=n||i.a.DEFAULT_IMAGELESS_PIN_COLOR,Object(s.jsx)(r.f,{rounding:2,height:216,width:"100%",dangerouslySetInlineStyle:{__style:{background:n}},children:Object(s.jsxs)(r.f,{maxHeight:200,padding:4,overflow:"hidden",children:[e&&Object(s.jsx)(r.f,{marginBottom:2,children:Object(s.jsx)(r.cb,{color:"white",size:"sm",children:Object(o.a)(e).hostname||e})}),Object(s.jsx)(r.f,{maxHeight:144,children:Object(s.jsx)(r.cb,{color:"white",overflow:"normal",weight:"bold",children:t})})]})})}},gONw:function(e,t,n){var i=n("q1tI"),o=n("n6mq"),r=n("nKUr");function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class a extends i.Component{constructor(...e){super(...e),s(this,"state",{isHovering:!1}),s(this,"onHover",()=>{this.setState({isHovering:!0})}),s(this,"offHover",()=>{this.setState({isHovering:!1})})}render(){const{name:e,selected:t,image:n,inFlyoutExp:i}=this.props;var s,a,c;return i?Object(r.jsxs)(o.f,{alignItems:"center",color:this.state.isHovering?"lightGray":"transparent",direction:"row",display:"flex",paddingX:4,paddingY:2,onMouseOver:this.onHover,onMouseOut:this.offHover,children:[Object(r.jsx)(o.f,{children:Object(r.jsx)(o.D,{height:40,width:40,rounding:2,children:this.state.isHovering&&n?Object(r.jsx)(o.y,{alt:"",color:"",fit:"cover",naturalHeight:null!==(s=n.height)&&void 0!==s?s:1,naturalWidth:null!==(a=n.width)&&void 0!==a?a:1,src:null!==(c=n.url)&&void 0!==c?c:""}):Object(r.jsx)(o.f,{color:"lightGray",height:40,width:40})})}),Object(r.jsx)(o.f,{padding:2,children:Object(r.jsx)(o.v,{size:"sm",children:e})})]}):Object(r.jsxs)(o.f,{alignItems:"center",color:t?"lightGray":"transparent",direction:"row",display:"flex",paddingX:6,paddingY:2,children:[Object(r.jsx)(o.f,{children:Object(r.jsx)(o.w,{color:t?"darkGray":"gray",icon:"add",accessibilityLabel:""})}),Object(r.jsx)(o.f,{marginStart:3,children:Object(r.jsx)(o.cb,{color:t?"darkGray":"gray",weight:"bold",children:e})})]})}}var c=n("yweb"),d=n("w70y"),l=n("U4JR"),u=n("seP0");t.a=({inFlyoutExp:e,inFirstBoardCreateGestaltExp:t,pinId:n,image:s,minHeight:h,onBoardSelected:b})=>{const p=Object(c.c)(),[m,f]=Object(i.useState)(-1),g=Object(u.c)(),{data:j=[],error:O,isLoaded:v}=Object(d.a)({name:"BoardTitleSuggestionsResource",options:{pin_id:n}}),x=(S=j,Object(i.useMemo)(()=>S&&S.length?S.map(e=>e.title):[],[S]));var S;Object(i.useEffect)(()=>{v&&t&&g&&(O?g.error():g.stop())},[v]);const y=()=>{f(-1)},_=(t,n)=>{const i=m===n;return Object(r.jsx)("li",{children:Object(r.jsx)(o.bb,{onMouseEnter:()=>(e=>{f(e)})(n),onMouseLeave:y,onTap:()=>(e=>{b(x[e],!1),Object(l.b)(101,{component:13025,element:23})})(n),children:Object(r.jsx)(a,{selected:i,name:t,inFlyoutExp:e,image:s})})},n)};return v?x&&x.length?e?Object(r.jsx)(o.f,{children:Object(r.jsx)("ul",{children:x.map(_)})}):t?Object(r.jsxs)(o.f,{children:[Object(r.jsx)(o.f,{marginTop:5,marginStart:6,marginBottom:3,children:Object(r.jsx)(o.cb,{children:p._("Suggested board names","text above suggested board names list","text above suggested board names list")})}),Object(r.jsx)("ul",{children:x.map(_)})]}):Object(r.jsxs)(o.f,{children:[Object(r.jsx)(o.f,{marginTop:2,paddingX:5,children:Object(r.jsx)(o.cb,{children:p._("Suggested board names")})}),Object(r.jsx)("ul",{children:x.map(_)})]}):null:Object(r.jsx)(o.u,{alignItems:"center",height:"100%",justifyContent:"center",minHeight:h||"",children:Object(r.jsx)(o.U,{accessibilityLabel:p._("Loading board suggestions","Accesibility label for loading board suggestions","Accesibility label for loading board suggestions"),show:!0})})}},i1AX:function(e,t,n){var i=n("q1tI"),o=n("TgLd"),r=n("eOdZ"),s=n("yweb"),a=n("n6mq"),c=n("nKUr");t.a=({onConfirm:e})=>{const t=Object(s.c)(),[n,d]=Object(i.useState)(!1),l=()=>{d(!0),r.d.create("ApiResource",{url:"/v3/users/email/verify/resend/"}).callCreate()};return Object(c.jsx)(o.b,{accessibilityModalLabel:t._("Verify your email","Accessible label for email verification being required","Accessible label for email verification being required"),onDismiss:e,heading:t._("Verify your email","Accessible label for email verification being required","Accessible label for email verification being required"),footer:Object(c.jsxs)(a.u,{justifyContent:"end",gap:2,children:[n?Object(c.jsx)(a.g,{fullWidth:!0,size:"lg",color:"gray",text:t._("Email sent","Button text for verification email being sent","Button text for verification email being sent"),disabled:n,onClick:l}):Object(c.jsx)(a.g,{fullWidth:!0,size:"lg",color:"gray",text:t._("Resend email","Button text for resending email verification email","Button text for resending email verification email"),disabled:n,onClick:l}),Object(c.jsx)(a.g,{fullWidth:!0,size:"lg",color:"red",text:t._("Got it","Button text for acknowledging email verificaiton is required","Button text for acknowledging email verificaiton is required"),onClick:e})]}),role:"alertdialog",children:Object(c.jsx)(a.f,{padding:8,children:Object(c.jsx)(a.cb,{align:"center",size:"lg",children:t._("Keep your account secure by verifying your email address. Check the inbox associated with this account for an email from us to continue using Pinterest.","Inform users that they need to verify their email to keep their account secure and continue using Pinterest","Inform users that they need to verify their email to keep their account secure and continue using Pinterest")})})})}},jHGc:function(e,t,n){n.r(t),n.d(t,"PinRepEditButton",(function(){return a}));var i=n("yweb"),o=n("dtqy"),r=n("n6mq"),s=n("nKUr");function a({handlePinEditButtonClick:e,style:t,useLegoStyles:n=!1,usePersistentOneClickSaveStyles:o,wrappingIconStyle:a,shouldUseLegoStyles:c,onDelete:d}){const l=Object(i.c)(),u=Object(s.jsx)(r.x,{accessibilityLabel:l._("Edit","edit button on pin","edit button on pin"),bgColor:t&&t.bgColor||"white",icon:"edit",iconColor:t&&t.iconColor||"darkGray",onClick:({event:t})=>e(t),size:t&&t.size||"md"});return c?Object(s.jsx)(r.g,{fullWidth:!0,size:"lg",color:"gray",text:l._("Saved","PinRepEditButton.SavedButton","saved button on pin"),onClick:d,accessibilityLabel:l._("Pin Saved Button","PinRepEditButton.SavedButtonLabel","saved button label on pin"),selected:!0}):n||o?Object(s.jsx)("div",{style:{...a||{}},children:u}):u}t.default=Object(o.a)(a)},l9OW:function(e,t,n){var i=n("SKAX"),o=n("MMmD");e.exports=function(e,t){var n=-1,r=o(e)?Array(e.length):[];return i(e,(function(e,i,o){r[++n]=t(e,i,o)})),r}},lQqw:function(e,t,n){var i=n("MMmD");e.exports=function(e,t){return function(n,o){if(null==n)return n;if(!i(n))return e(n,o);for(var r=n.length,s=t?r:-1,a=Object(n);(t?s--:++s<r)&&!1!==o(a[s],s,a););return n}}},"lm/5":function(e,t,n){var i=n("fmRc"),o=n("wF/u");e.exports=function(e,t,n,r){var s=n.length,a=s,c=!r;if(null==e)return!a;for(e=Object(e);s--;){var d=n[s];if(c&&d[2]?d[1]!==e[d[0]]:!(d[0]in e))return!1}for(;++s<a;){var l=(d=n[s])[0],u=e[l],h=d[1];if(c&&d[2]){if(void 0===u&&!(l in e))return!1}else{var b=new i;if(r)var p=r(u,h,l,e,t,b);if(!(void 0===p?o(h,u,3,r,b):p))return!1}}return!0}},lm6u:function(e,t,n){n.d(t,"a",(function(){return B}));var i=n("q1tI"),o=n("/MKj"),r=n("1inl"),s=n("3z7j"),a=n("ajUs");var c=n("e/jn"),d=n("x12c"),l=n("eOdZ"),u=n("G35+"),h=n("M1Uz"),b=n("xkL+"),p=n("Wrea"),m=n("Vzit"),f=n("6G9P"),g=n("xjIv"),j=n("WnNx"),O=n("n6mq"),v=n("U4JR"),x=n("NjDU"),S=n("yweb"),y=n("B6Tf"),_=n("seP0"),w=n("nGHF"),C=n("oN2T"),I=n("EC67"),T=n("nKUr");function R(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const P=/#[^(\-\\.\s#,\/$%\^&\*;:{}=\`~()\[\]@|<>…)]+/gi;class E extends i.Component{constructor(...e){super(...e),R(this,"state",{boardSavedTo:null,displaySuccessAnimation:!1,newPin:null,modalTitle:this.getModalTitle(this.props.showCreate,!!this.props.boardWithSection),pinDescription:this.props.pin&&this.props.pin.description||"",resolve:void 0,sharing:{facebook:!1,twitter:!1}}),R(this,"unmounted",!1),R(this,"setModalTitle",e=>this.safeSetState({modalTitle:e})),R(this,"updateDescription",e=>{this.safeSetState({pinDescription:e})}),R(this,"close",()=>{const{onClose:e,boardPickerStopwatch:t}=this.props;e&&e(),t&&t.abort("boardPickerClose"),Object(v.b)(2502,{component:5,element:610})}),R(this,"safeSetState",(e,t)=>{this.unmounted?t&&t():this.setState(e,t)}),R(this,"getPinResource",(e,t,n)=>{var i,o;const{color:r,location:s,pin:d,method:u,guid:h,additionalCreateFields:b,advertiser_id:p,previousHistory:m}=this.props;let f;d.id&&(f=Object(a.a)(d,s,m)||(d.tracking_params||"")+"~0");const g=d.id?"RepinResource":"PinResource",j=!d.id&&d.image_url?Object(c.a)(d.image_url,d.link):(null===(i=d.images)||void 0===i||null===(o=i.orig)||void 0===o?void 0:o.url)||"",O={...b,board_id:t||"",color:r||"",clientTrackingParams:f,description:this.state.pinDescription,guid:h||"",link:d.link,image_base64:d.image_base64,image_url:j,is_buyable_pin:!1,is_removable:d.promoted_is_removable,media_upload_id:d.media_upload_id,method:u||"",pin_id:d.id||"",section:n,title:d.title||"",...p?{advertiser_id:p}:Object.freeze({})};if(!e){const{facebook:e,twitter:t}=this.state.sharing;O.share_facebook=e,O.share_twitter=t}return l.d.create(g,O)}),R(this,"triggerPubSubs",e=>{d.a.instance.publish("currentUser","pinCreated",e),d.a.instance.publish(e.board.id,"pinCreated",{pin:e})}),R(this,"makeCancelablePromise",e=>{let t=!1;return{promise:new Promise((n,i)=>{e.then(e=>t?i({isCanceled:!0}):n(e)),e.catch(e=>i(t?{isCanceled:!0}:e))}),cancel(){t=!0}}}),R(this,"handleLogToastClick",()=>{Object(v.b)(101,{component:20,view:52})}),R(this,"showSuggestedBoardToast",(e,t,n,o)=>{const{toastManagerContext:r,shouldShowToast:s}=this.props;if(s&&e){const{name:t,url:n,image_thumbnail_url:o}=e;r.showOneToast(({onHide:e})=>Object(T.jsx)(h.a,{duration:y.a,onHide:e,text:Object(T.jsxs)(i.Fragment,{children:[Object(T.jsx)(O.cb,{children:this.props.i18n._("You might also like","Post repin suggested board","Post repin suggested board")}),Object(T.jsx)(O.cb,{weight:"bold",children:t})]}),href:n,imageUrl:o,onClick:this.handleLogToastClick}))}}),R(this,"showBoardSavedToast",(e,t)=>{const{toastManagerContext:n,i18n:i}=this.props;n.showToast(({onHide:n})=>{var o,r;return Object(T.jsx)(h.a,{duration:y.a,onHide:n,text:Object(f.a)(i,e.name,t),href:t?`${null!==(o=e.url)&&void 0!==o?o:""}${t.slug}`:e.url,imageUrl:null!==(r=e.image_cover_url)&&void 0!==r?r:"",onClick:this.handleLogToastClick})})}),R(this,"dismissModal",e=>{const{resolve:t,newPin:n}=this.state;t&&t(n)}),R(this,"fetchBoardRecommendation",e=>l.d.create("RelatedBoardForPinRandomFeedResource",{pin:e.id,page_size:1}).callGet({showError:!1}).then(e=>Promise.resolve(e.resource_response.error?null:e.resource_response.data[0]))),R(this,"handleBoardSaveSuccess",(e,t,n,i)=>{var o,r;const{action:a,dispatch:c,hideSuccessAnimation:d,homeTakeoverExperience:l,pin:u,setCompletionPromise:h,shouldShowToast:b,viewerUserId:f}=this.props;c(Object(m.d)());const O=e.resource_response.data,S=this.makeCancelablePromise(new Promise((e,o)=>{this.triggerPubSubs(O);const r=this.state.pinDescription.match(P)||[];r.length>0&&Object(v.b)(2,{element:10273,hashtags:JSON.stringify(r),objectId:this.props.pin.id});const s=d?()=>{}:()=>{b&&this.showBoardSavedToast(t,n),this.safeSetState({displaySuccessAnimation:!0,modalTitle:this.props.i18n._("Board created","Modal title after creating a new board","Modal title after creating a new board"),newPin:O,resolve:e})};"repin"===a?(this.fetchBoardRecommendation(O).then(e=>{this.showSuggestedBoardToast(e,O,n,i)}),i?s():e(O)):("create"===a&&l&&500840===l.experience_id&&(c({type:"PIN_CREATED_VIA_CREATOR_CHECKLIST",payload:{pin_created_via_creator_checklist:!0}}),Object(v.b)(7510,{component:13233})),i?s():e(O))}));if(i||c(Object(j.d)(u.id)),h(S),c(Object(C.d)(t)),c(Object(p.d)({boardId:t.id,sectionId:n&&n.id,increment:1})),f&&(c(Object(x.c)({userId:f,increment:1})),c(Object(m.d)())),n||!t.image_cover_url){const{image_url:e,images:n}=u;t.image_cover_url=e||n&&n["236x"]&&n["236x"].url||"",c(Object(C.e)({},t))}n&&c(Object(s.a)(n.id)),c(Object(g.a)(u.id,t.id,null!==(o=t.name)&&void 0!==o?o:"",null!==(r=t.url)&&void 0!==r?r:"",O.id))}),R(this,"handleSaveToBoard",(e,t,n)=>{const{boardPickerStopwatch:i,onToggleModal:o,shouldShowToast:s}=this.props;i&&i.abort("boardPickerSubmit"),s&&!n&&(this.close(),this.showBoardSavedToast(e,t));const a="secret"===(e.privacy||""),c={board:t?t.id:e.id,state:y.b.LOADING};this.safeSetState({boardSavedTo:c},()=>{this.getPinResource(a,e.id,(t||{}).id).callCreate({showError:!1}).then(i=>{this.safeSetState({boardSavedTo:Object.assign(c,{state:y.b.SUCCESS})},()=>this.handleBoardSaveSuccess(i,e,t,n)),o&&!n&&o(!1)}).catch(e=>{this.unmounted||this.safeSetState({boardSavedTo:null}),r.a.showError(e.message_detail||e.message);const t=this.makeCancelablePromise(Promise.reject(e));this.props.setCompletionPromise(t),o&&o(!1)})})}),R(this,"handleSocialConnectSet",(e,t)=>{const n=Object.assign({},this.state.sharing);e===u.a.FACEBOOK?n.facebook=t:e===u.a.TWITTER&&(n.twitter=t),this.safeSetState({sharing:n})}),R(this,"handleNewBoardAnimationCompletion",()=>{const{dispatch:e,pin:t}=this.props;e(Object(j.d)(t.id))})}getModalTitle(e,t){return e?t?this.props.i18n._("Create section","modal title for create section pane","modal title for create section pane"):this.props.i18n._("Create board","Repin title for making a new board","Repin title for making a new board"):t?this.props.i18n._("Choose section","modal title for choose section","modal title for choose section"):this.props.i18n._("Choose board","Repin title for choosing a board","Repin title for choosing a board")}componentDidUpdate(e){const{boardWithSection:t,showCreate:n,pin:i,description:o}=this.props,r={};i===e.pin&&o===e.description||(r.pinDescription=i.description||o||""),n===e.showCreate&&t===e.boardWithSection||(r.modalTitle=this.getModalTitle(n,!!t)),Object.keys(r).length>0&&this.safeSetState(r)}componentWillUnmount(){this.unmounted=!0}render(){const{close:e,dismissModal:t,handleNewBoardAnimationCompletion:n,handleSaveToBoard:i,handleSocialConnectSet:o,setModalTitle:r,updateDescription:s}=this,{boardSavedTo:a,displaySuccessAnimation:c,modalTitle:d,newPin:l}=this.state,{color:u,pin:h}=this.props;return this.props.children({boardSavedTo:a,color:u,dismissModal:t,displaySuccessAnimation:c,handleAbort:e,handleNewBoardAnimationCompletion:n,handleSaveToBoard:i,handleSocialConnectSet:o,modalTitle:d,newPin:l,pin:h,setModalTitle:r,updateDescription:s})}}function B(e){const t=Object(S.c)(),n=Object(_.c)(),i=Object(I.i)(),r=Object(b.b)(),s=Object(w.b)(),a=Object(o.useDispatch)(),c=Object(o.useSelector)(({advertiser:e})=>r.isAuth&&e&&e.owner_user_id!==r.id?e.id:void 0),d=Object(o.useSelector)(({experiences:e})=>e.eligibleExperiences[11]),l=Object(o.useSelector)(({experiences:e})=>e.eligibleExperiences[33]),u=Object(o.useSelector)(({history:e})=>e.previous);return Object(T.jsx)(E,{...e,advertiser_id:c,boardPickerStopwatch:n,dispatch:a,location:i,homeTakeoverExperience:d,previousHistory:u,repinTakeoverExperience:l,toastManagerContext:s,viewerUserId:r.isAuth?r.id:void 0,i18n:t})}},"mVx/":function(e,t,n){var i=n("XKAG")(n("JELi"));e.exports=i},mvLR:function(e,t,n){function i(e){let t=!1;return{promise:new Promise((n,i)=>{e.then(e=>t?i({isCanceled:!0}):n(e),e=>i(t?{isCanceled:!0}:e))}),cancel(){t=!0}}}n.d(t,"a",(function(){return i}))},oRM1:function(e,t,n){n.d(t,"a",(function(){return r}));var i=n("q1tI"),o=n("zQfT");function r({allowSearchOnMount:e,children:t,onTypeaheadSuggestionsChange:n,resourceName:r,resourceOptions:s,value:a}){const c=Object(o.a)({allowSearchOnMount:e,resourceName:r,resourceOptions:s,value:a});return Object(i.useEffect)(()=>{null!=c&&c.length&&n(c)},[c]),t||null}},ou9u:function(e,t,n){function i(e){const t=e.videos&&e.videos.video_list&&Object.keys(e.videos.video_list).length>0?e.videos.video_list:null;return t?t.V_HLSV3_MOBILE||t.V_HLSV4||t.V_720P:null}n.d(t,"a",(function(){return i}))},qnp8:function(e,t,n){n.d(t,"a",(function(){return d}));var i=n("EC51"),o=n("M1Uz"),r=n("yweb"),s=n("vvax"),a=n("n6mq"),c=n("nKUr");function d({boardName:e,boardUrl:t,isBoardlessPin:n,isFromPinBuilder:d,newPin:l,onChangeButtonClick:u,onVisitButtonClick:h=(()=>{}),onHide:b,onUndo:p,pinImageUrl:m}){const f=Object(r.c)(),g=Object(c.jsx)(a.f,{color:"lightGray",display:"flex",height:48,overflow:"hidden",width:48,children:Object(c.jsx)(a.f,{padding:3,children:Object(c.jsx)(a.w,{accessibilityLabel:f._("Saved to profile thumbnail","PostSavedPinToast.thumbnail.accessibilityLabel","Thumbnail for saved to profile."),color:"darkGray",icon:"history",size:24})})}),j=(!!u||!!p)&&Object(c.jsx)(a.g,{text:l&&n&&u?f._("Change","PostSavedPinToast.ChangeButton","Change saved pin to a different destination"):f._("Undo","PostSavedPinToast.UndoButton","Undo Saved Pin"),size:"lg",onClick:l&&n&&u?()=>u(l):p},"button-key"),O=Object(c.jsx)(a.g,{text:f._("Visit","PostSavedPinToast.VisitButton","Visit Pin saved from PinBuilder"),size:"lg",onClick:h});return Object(c.jsx)(o.a,{button:d?O:j,duration:n?6e3:3e3,iconThumbnail:n?g:void 0,imageUrl:m,onHide:b,text:Object(c.jsx)(a.cb,{size:"md",lineClamp:1,children:Object(s.b)(f._("Saved to {{ destination }}","PostSavedPinToast.SavedToBoardLabel","Saved to label for better save"),{destination:Object(c.jsx)(i.a,{href:n?"/me/":null!=t?t:"",children:Object(c.jsx)(a.cb,{size:"md",weight:"bold",lineClamp:1,children:e},"PostSavedPinToastBoardName")})})})})}},qyR9:function(e,t,n){n.d(t,"a",(function(){return g}));var i=n("q1tI"),o=n("jdx6"),r=n("gONw"),s=n("yweb"),a=n("gdcG"),c=n("n6mq"),d=n("nKUr");var l=Object(a.a)((function(e){const t=Object(s.c)(),{buttonLabel:n,isHovering:i,isRowItem:o,hasHoverState:r,hoverHandlers:a,name:l,onClick:u}=e,h=l||n||t._("Create board");return Object(d.jsx)(c.bb,{onMouseEnter:a.onMouseOver,onMouseLeave:a.onMouseLeave,onTap:u,children:Object(d.jsxs)(c.f,{alignItems:"center",color:r&&i?"lightGray":"white",display:"flex",flex:o?"shrink":"none",height:64,width:"100%",children:[Object(d.jsx)(c.f,{marginStart:6,marginEnd:3,"data-test-id":"createBoardButton",children:Object(d.jsx)(c.w,{accessibilityLabel:t._("Add a board"),size:"32",icon:"add-circle",color:"red"})}),l?Object(d.jsx)(c.f,{margin:1,children:Object(d.jsxs)(c.cb,{inline:!0,overflow:"normal",children:[" ",t._("Create: ")," "]})}):null,Object(d.jsxs)(c.cb,{align:"center",inline:!0,lineClamp:1,weight:"bold",children:[" ",h," "]})]})})})),u=n("9QW3"),h=n("NdQN"),b=n("IBrh"),p=n("seP0");function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class f extends i.Component{constructor(...e){super(...e),m(this,"state",{searchQuery:""}),m(this,"handleSelectItem",e=>{const{onCreate:t,onSelected:n}=this.props;if(!e&&t){const{searchQuery:e}=this.state;t(e)}else e&&n(e);(t||e)&&this.setState({searchQuery:""})}),m(this,"handleSearchQueryInput",e=>{this.setState({searchQuery:e})}),m(this,"renderSectionHeader",(e,t)=>e.title?Object(d.jsxs)(c.f,{children:[t>0&&Object(d.jsx)(c.q,{}),Object(d.jsx)(c.f,{paddingX:3,paddingY:1,children:Object(d.jsx)(c.cb,{size:"md",children:e.title})})]}):null),m(this,"renderRow",({item:e,hovered:t,sectionProps:n={}})=>{const{boardSavedTo:i,isSelectMode:r,disabledRowId:s}=this.props,{searchQuery:a}=this.state,{inSectionSelection:c=!1}=n,l=i&&i.board===e.id?i&&i.state:null,u="board_section"===e.type;return Object(d.jsx)(o.a,{disabled:e.id===s&&c,isSection:u,isSelectMode:r,isWithinSectionPicker:c,item:e,saveState:l,searchQuery:a,selected:t})})}componentDidUpdate(e){if(!e.isLoaded&&this.props.isLoaded){const{boardPickerStopwatch:e,hasLoadError:t}=this.props;e&&(t?e.error():e.stop())}}render(){const{boardSavedTo:e,createButtonLabel:t,hasLowBoardCount:n,getSections:i,isLoaded:o,onCreate:s,pinId:a}=this.props;if(o){const{searchQuery:o}=this.state,p=i(o);return this.indexManager=new u.a(p.map(e=>e.items)),this.indexManager.setSelectItem(this.handleSelectItem),Object(d.jsxs)(c.f,{minHeight:0,flex:"grow",height:"100%",overflow:"auto",display:"flex",direction:"column",dangerouslySetInlineStyle:{__style:{zIndex:0}},children:[!n&&Object(d.jsxs)(c.f,{children:[Object(d.jsx)(c.f,{paddingX:3,marginBottom:4,marginTop:1,children:Object(d.jsx)(h.a,{disabled:!!e,indexManager:this.indexManager,onChange:this.handleSearchQueryInput,value:o})}),Object(d.jsx)(c.q,{})]}),Object(d.jsx)(b.a,{disabled:!!e,grow:!n&&!o,indexManager:this.indexManager,onSelectItem:this.handleSelectItem,renderItem:this.renderRow,renderSectionHeader:this.renderSectionHeader,sections:p}),Object(d.jsx)(c.q,{}),s&&Object(d.jsx)(l,{buttonLabel:t,hasHoverState:!0,name:o,onClick:()=>s(o)}),n&&s&&a&&Object(d.jsx)(r.a,{onBoardSelected:s,pinId:a})]})}return Object(d.jsx)(c.f,{paddingY:5,children:Object(d.jsx)(c.U,{accessibilityLabel:this.props.i18n._("loading section picker","accessibility label for the loading spinner the repin picker","accessibility label for the loading spinner the repin picker"),show:!0})})}}function g(e){const t=Object(s.c)(),n=Object(p.c)();return Object(d.jsx)(f,{...e,boardPickerStopwatch:n,i18n:t})}},r8eU:function(e,t,n){n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return a}));var i=n("QLaP"),o=n.n(i);class r{constructor(e,t){o()(e,"You must pass a requestContext to check an Experiment"),o()(t,"You must pass the name of the experiment to check"),this.requestContext=e,this.experimentName=t.toLowerCase()}_getGroup(e){return e?this.requestContext.experiments.v2ActivateExperiment(this.experimentName)||"":this.requestContext.experiments.v2GetGroup(this.experimentName)||""}}class s extends r{getGroup(e=!1){return this._getGroup(e)}}class a extends r{_isTreatment(e){return e.startsWith("enabled")||e.startsWith("employee")}enabled(){return this._isTreatment(this._getGroup(!0))}enabledWithNoActivation(){return this._isTreatment(this._getGroup(!1))}}},s7xj:function(e,t,n){n.d(t,"a",(function(){return u}));var i=n("xweI"),o=n.n(i),r=n("yweb"),s=n("xkL+"),a=n("n6mq"),c=n("qpbZ"),d=n("nKUr");function l(e){var t,n;const i=null!==(t=e.imageMediumUrl)&&void 0!==t?t:e.image_medium_url;return{name:null!==(n=e.fullName)&&void 0!==n?n:e.full_name,src:"https://s.pinimg.com/images/user/default_75.png"===i?void 0:i}}function u({board:e,forceViewer:t,isCompact:n,ownerOnly:i}){const u=Object(r.c)(),h=Object(s.b)(),b=i?[l(e.owner)]:function(e,t,n){const{collaborated_by_me:i,collaborating_users:r=[],owner:s}=e,a=[s];if(i||n){const e=r.findIndex(e=>t.isAuth&&e.id===t.id);if(-1!==e){const t=r.splice(e,1)[0];a.push(t)}else a.push(t)}const c=o()(r,"full_name");return[...a,...c]}(e,h,t).map(l),p=b.slice(0,3).map(e=>e.name);let m="";switch(b.length){case 3:m=Object(c.c)(""+u._("{{ first }}, {{ second }}, and {{ last }}","CollaboratorsFacePile.AvatarGroup.accessibilityLabel.usernames.ThreeAvatars","List of three usernames"),{first:""+p[0],second:""+p[1],last:""+p[2]});break;case 2:m=Object(c.c)(""+u._("{{ first }} and {{ second }}","CollaboratorsFacePile.AvatarGroup.accessibilityLabel.usernames.TwoAvatars","List of two usernames."),{first:""+p[0],second:""+p[1]});break;default:m=p.join(", ")}const f=b.length>3?Object(c.c)(", "+u.ngettext("Collaborators: {{ userNames }} and {{ leftCount }} more.","Collaborators: {{ userNames }} and {{ leftCount }} more.",b.length-3,"CollaboratorsFacePile.AvatarGroup.accessibilityLabel.aboveThree","Accessibility label that lists the names of collaborators and a final count of non-displayed avatars"),{userNames:m,leftCount:""+(b.length-3)}):Object(c.c)(", "+u._("Collaborators: {{ userNames }}.","CollaboratorsFacePile.AvatarGroup.accessibilityLabel.notAboveThree","Accessibility label that lists the names of collaborators"),{userNames:m});return Object(d.jsx)(a.c,{accessibilityLabel:f,collaborators:b,size:n?"xs":"sm"})}},"sH+O":function(e,t,n){function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return r}));const o=(e,t)=>{const n=/^\d{1,3}\.\d{1,3}(?:\.\d{1,6})?$/;if(null==e||!e.match(n)||null==t||!t.match(n))return null;const i=null==e?void 0:e.split("."),o=null==t?void 0:t.split("."),r=Math.max((null!=i?i:"").length,(null!=o?o:"").length);for(let c=0;c<r;c+=1){var s,a;const e=c<(null!==(s=null==i?void 0:i.length)&&void 0!==s?s:0)?parseInt(null==i?void 0:i[c],10):0,t=c<(null!==(a=null==o?void 0:o.length)&&void 0!==a?a:0)?parseInt(null==o?void 0:o[c],10):0;if(e<t)return-1;if(e>t)return 1}return 0};class r{constructor(e,t,n){i(this,"start",Date.now()),i(this,"paused",!1),this.onProgress=e,this.onComplete=t,this.duration=n,this.remaining=n,"undefined"!=typeof window&&(this.intervalId=window.setInterval(()=>{const e=this.paused?this.duration-this.remaining:this.duration-this.remaining+(Date.now()-this.start);this.onProgress(e/this.duration)},500),this.resume())}currentTime(){return this.duration-this.remaining}pause(){this.paused=!0,window.clearTimeout(this.timerId),this.remaining-=Date.now()-this.start;const e=this.duration-this.remaining;this.onProgress(e/this.duration)}resume(){this.paused=!1,this.start=Date.now(),window.clearTimeout(this.timerId),this.timerId=window.setTimeout(this.onComplete,this.remaining)}clear(){window.clearTimeout(this.timerId),window.clearInterval(this.intervalId)}}},seP0:function(e,t,n){n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return c})),n.d(t,"c",(function(){return d}));var i=n("FZ8N"),o=n("F4HH");const{Provider:r,useHook:s}=Object(o.a)({name:"board_picker",v2LoggerMetricName:16,sampleRate:i.b?1:.1}),a=(e,t)=>{let n="unknown";null!=t&&t.includes("pin/")?n="PinCloseup":"/"===t?n="HomeFeed":"PinBookMarklet"===t&&(n="PinBookmarklet"),null==e||e.addBinaryAnnotation("source",n,"STRING")},c=r,d=s},"ut/Y":function(e,t,n){var i=n("ZCpW"),o=n("GDhZ"),r=n("zZ0H"),s=n("Z0cm"),a=n("+c4W");e.exports=function(e){return"function"==typeof e?e:null==e?r:"object"==typeof e?s(e)?o(e[0],e[1]):i(e):a(e)}},uyxo:function(e,t,n){n.d(t,"a",(function(){return s}));var i=n("jHGc"),o=n("n6mq"),r=n("nKUr");function s(e){const{children:t,currentCarouselIndex:n,onDeleteSavedState:s,onEditSubmit:a,onToggleModal:c,pinId:d,variant:l,viewParameter:u,shouldUseLegoStyles:h}=e,b="pin"===l?{bgColor:"white",iconColor:"darkGray",size:"sm"}:{bgColor:"transparent",iconColor:"darkGray",size:"sm"};return Object(r.jsxs)(o.f,{alignItems:"center",display:"flex",direction:"row",marginStart:"pin"===l?-1:void 0,marginEnd:"pin"===l?-1:void 0,paddingX:"closeup"!==l||h?void 0:2,width:"closeup"===l?"100%":void 0,height:"100%",children:[t&&Object(r.jsx)(o.f,{paddingX:1,"data-test-id":"saved-info",flex:"grow",children:t}),Object(r.jsx)(o.f,{paddingX:1,flex:"none",marginStart:"auto",children:Object(r.jsx)(i.default,{component:0,onDelete:s,onSubmit:a,pinId:d,onToggleModal:c,viewParameter:u,carouselSlotCurrentIndex:n,style:b,shouldUseLegoStyles:h,useLegoStyles:"pin"===l})})]})}},"v+PR":function(e,t,n){n.d(t,"a",(function(){return f}));var i=n("q1tI"),o=n("yweb"),r=n("w70y"),s=n("vvax"),a=n("n6mq"),c=n("nKUr");function d({pin:e}){const t=Object(o.c)(),{data:n}=Object(r.a)({name:"ApiResource",options:{url:`/v3/pins/${e.id}/`,field_sets:["pin.board()","pin.id","pin.pinned_to_board()","pin.type","pin.via_pinner()"]},noCache:!0});return n&&n.pinned_to_board&&"quick_creates"!==n.pinned_to_board.layout?Object(c.jsxs)(a.f,{children:[Object(c.jsx)(a.f,{color:"red","data-test-id":"already-pinned",display:"flex",padding:3,rounding:2,width:185,children:Object(c.jsx)(a.cb,{align:"center",color:"white",size:"md",weight:"bold",children:Object(s.b)(t._("Psst! You already saved this Pin to {{ board_name }} ","Toast for already having repinned pin","Toast for already having repinned pin"),{board_name:(n.pinned_to_board||{}).name}).join(" ")})}),Object(c.jsx)(a.f,{display:"flex",justifyContent:"center",marginTop:-3,children:Object(c.jsx)(a.w,{accessibilityLabel:"",color:"red",icon:"heart",size:26})})]}):null}var l=n("P6kd"),u=n("g/XF"),h=n("U4JR");function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const p=/#[^(. #,\/$%\^&\*;:{}=\`~()\[\]@|<>)]*/,m=/#[^(. #,\/$%\^&\*;:{}=\`~()\[\]@|<>)]*$/;class f extends i.Component{constructor(...e){super(...e),b(this,"state",{cursorIndex:-1,flyoutCursorIndex:-1,description:this.props.pin&&this.props.pin.description&&this.props.pin.description.trim()||"",editing:!1,hashtagQuery:"",isHashtagFlyoutOpen:!1,flyoutOpened:!1}),b(this,"onDescriptionChange",(e,t)=>{const n=new RegExp(p,"g");let i="";if(t<e.length){let o=n.exec(e),r=n.lastIndex<t;for(;o&&r;)o=n.exec(e),r=n.lastIndex<t;const s=!!o&&p.test(e.slice(o.index,t));r=!!o&&o.index<t,o&&s&&r&&(i=o[0])}else{const t=m.exec(e);i=t?t[0]:""}this.updateDescription(e);const o=p.test(i),r=this.state.isHashtagFlyoutOpen?this.state.flyoutCursorIndex:e.slice(0,t).lastIndexOf("#");this.setState({cursorIndex:t,flyoutCursorIndex:r,description:e,hashtagQuery:i,isHashtagFlyoutOpen:o,flyoutOpened:this.state.flyoutOpened||o})}),b(this,"onCursorChange",e=>{const{isHashtagFlyoutOpen:t,flyoutCursorIndex:n}=this.state;t&&e<n&&this.setState({isHashtagFlyoutOpen:!1})}),b(this,"updateDescription",e=>{this.props.updateDescription&&this.props.updateDescription(e)}),b(this,"handleDescriptionBlur",e=>{const t=e.target.value.trim(),{isHashtagFlyoutOpen:n}=this.state;this.updateDescription(t),this.setState({description:t,editing:n})}),b(this,"handleDescriptionEdit",()=>{this.setState({editing:!0})}),b(this,"handleHashtagAddition",e=>{const{pin:t}=this.props;Object(h.b)(101,{component:208,element:10249,hashtags:e,objectId:t.id});const n=this.state.flyoutCursorIndex,i=Number(n+this.state.hashtagQuery.length),o=this.state.description.slice(0,n)+e+" "+this.state.description.slice(i);this.updateDescription(o),this.setState({description:o,editing:!0,hashtagQuery:"",isHashtagFlyoutOpen:!1})}),b(this,"handleRefTextArea",e=>{this._textArea=e})}render(){const{color:e,isFirstPin:t,pin:n,pinImageRef:i}=this.props,{description:o,editing:r,flyoutOpened:s,hashtagQuery:h,isHashtagFlyoutOpen:b}=this.state,{images:p,link:m}=n,f=p&&p["236x"],g=f&&f.url||n.image_base64;return Object(c.jsxs)(a.f,{display:"flex",alignItems:"center",justifyContent:"center",position:"relative",width:t?"50%":"",dangerouslySetInlineStyle:{__style:s&&r?{transform:"translateY(-75px)"}:{}},children:[Object(c.jsxs)(a.u,{alignItems:"center",direction:"column",justifyContent:"start",children:[n&&n.id&&Object(c.jsx)(d,{pin:n}),Object(c.jsx)(a.f,{paddingY:t?9:0,width:240,children:Object(c.jsx)(a.f,{ref:i,maxHeight:s&&r?220:335,rounding:4,overflow:"hidden",children:g?Object(c.jsx)(a.y,{alt:o,src:g,naturalHeight:(null==f?void 0:f.height)||1,naturalWidth:(null==f?void 0:f.width)||1}):!!m&&Object(c.jsx)(u.a,{color:e||"",description:o,url:m})})})]}),this.anchor&&b?Object(c.jsx)(l.a,{addHashtag:this.handleHashtagAddition,anchor:this.anchor,editing:r,query:h}):null]})}}},xjIv:function(e,t,n){function i(e,t,n,i,o){return{type:"PIN_SAVE",payload:{pinId:e,boardId:t,title:n,url:i,localPinId:o}}}function o(e){return{type:"PIN_UNSAVE",payload:{pinId:e}}}n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}))},xweI:function(e,t,n){var i=n("XGnz"),o=n("alwl"),r=n("EA7m"),s=n("mv/X"),a=r((function(e,t){if(null==e)return[];var n=t.length;return n>1&&s(e,t[0],t[1])?t=[]:n>2&&s(t[0],t[1],t[2])&&(t=[t[0]]),o(e,i(t,1),[])}));e.exports=a},yKES:function(e,t,n){n.d(t,"a",(function(){return a}));var i=n("US8k"),o=n("yweb"),r=n("n6mq"),s=n("nKUr");function a({duration:e}){const t=Object(o.c)();return Object(s.jsxs)(r.f,{alignItems:"center",color:"transparentDarkGray",display:"flex",height:24,justifyContent:"center",paddingX:2,rounding:"pill",children:[Object(s.jsx)(r.w,{accessibilityLabel:t._("Video camera icon","Video camera indicator icon for a Pin","Video camera indicator icon for a Pin"),color:"white",icon:"video-camera"}),Object(s.jsx)(r.f,{marginStart:1,children:Object(s.jsx)(r.cb,{color:"white",size:"sm",lineClamp:1,children:Object(i.a)(e)})})]})}},yue5:function(e,t,n){var i=n("/9aa");e.exports=function(e,t){if(e!==t){var n=void 0!==e,o=null===e,r=e==e,s=i(e),a=void 0!==t,c=null===t,d=t==t,l=i(t);if(!c&&!l&&!s&&e>t||s&&a&&d&&!c&&!l||o&&a&&d||!n&&d||!r)return 1;if(!o&&!s&&!l&&e<t||l&&n&&r&&!o&&!s||c&&n&&r||!a&&r||!d)return-1}return 0}},zQfT:function(e,t,n){n.d(t,"a",(function(){return d}));var i=n("q1tI");const o=function(e,t){this.uid=e,this.item=t,this.next=null,this.prev=null},r=function(e){this._maxNumItems=e||10,this._uidToData={},this._numItems=0,this._firstData=null,this._lastData=null};r.prototype.set=function(e,t){let n=this._uidToData[e];n||(n=new o(e,t),this._uidToData[e]=n,this._numItems+=1),this._moveToFront(n),this._numItems>this._maxNumItems&&this._evict()},r.prototype.get=function(e){const t=this._uidToData[e];return t?(this._moveToFront(t),t.item):null},r.prototype.remove=function(e){const t=this._uidToData[e];t&&(delete this._uidToData[e],this._firstData===t&&(this._firstData=t.next),this._lastData===t&&(this._lastData=t.prev),t.prev&&(t.prev.next=t.next),t.next&&(t.next.prev=t.prev),this._numItems-=1)},r.prototype._moveToFront=function(e){this._firstData!==e&&(this._firstData?(this._lastData===e&&(this._lastData=e.prev),e.prev&&(e.prev.next=e.next),e.next&&(e.next.prev=e.prev),this._firstData.prev=e,e.next=this._firstData,e.prev=null,this._firstData=e):(this._firstData=e,this._lastData=e))},r.prototype._evict=function(){delete this._uidToData[this._lastData.uid],this._firstData===this._lastData?(this._firstData=null,this._lastData=null):(this._lastData=this._lastData.prev,this._lastData.next=null),this._numItems-=1};var s=r,a=n("eOdZ");function c({resourceName:e,resourceOptions:t}){const n={...t,count:"count"in t?t.count:5},i=a.d.create(e,n),o=new s,r=()=>{i.abort()};return async function(e){const t=o.get(e);if(t){const n=t.items;if(n&&n.length){r();return{hint:t.hint,items:n,term:e}}}return e.length>=0?(async e=>{var t;if(i.isCalling()){var n;if(e===(null===(n=i.options)||void 0===n?void 0:n.term))return;r()}const{bookmarks:s,...a}=i.options||{};i.options={...a,term:e};const c=null===(t=(await i.callGet({showError:!1})).resource_response)||void 0===t?void 0:t.data,d=null==c?void 0:c.items,l=(null==c?void 0:c.hint)||{},u={hint:l,items:d};return o.set(e,u),{term:e,items:d,hint:l}})(e):{hint:{},items:[],term:e}}}function d({allowSearchOnMount:e=!1,resourceName:t,resourceOptions:n={},value:o}){const r=Object(i.useRef)(!1),s=Object(i.useRef)({}),[a,d]=Object(i.useState)([]),l=function({resourceName:e,resourceOptions:t}){const n=Object(i.useRef)();return n.current||(n.current=c({resourceName:e,resourceOptions:t})),n.current}({resourceName:t,resourceOptions:n});return Object(i.useEffect)(()=>{(async()=>{if(null!=o&&(e||r.current))if(o in s.current)d(s.current[o]);else try{const e=await l(o);if(e){const{items:t}=e;s.current[o]=t,d(t)}}catch(t){if("Resource call aborted"===t)return;throw t}r.current||(r.current=!0)})()},[o]),a}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/PinBetterSaveCommon-b8d0946bda6993d1adb7.mjs.map